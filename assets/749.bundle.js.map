{"version":3,"file":"749.bundle.js","mappings":"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","sources":["webpack://liveblog/./src/react/Editor/LexicalEditor.js"],"sourcesContent":["/**\n * LexicalEditor - Production implementation using Lexical\n *\n * Lexical is the official successor to Draft.js from the same team at Meta.\n *\n * @see https://lexical.dev/\n */\n\nimport React, { useEffect, useCallback, useRef, useState } from 'react';\nimport PropTypes from 'prop-types';\n\nimport { LexicalComposer } from '@lexical/react/LexicalComposer';\nimport { RichTextPlugin } from '@lexical/react/LexicalRichTextPlugin';\nimport { ContentEditable } from '@lexical/react/LexicalContentEditable';\nimport { HistoryPlugin } from '@lexical/react/LexicalHistoryPlugin';\nimport { OnChangePlugin } from '@lexical/react/LexicalOnChangePlugin';\nimport { useLexicalComposerContext } from '@lexical/react/LexicalComposerContext';\nimport { LexicalErrorBoundary } from '@lexical/react/LexicalErrorBoundary';\nimport { LinkPlugin } from '@lexical/react/LexicalLinkPlugin';\nimport { ListPlugin } from '@lexical/react/LexicalListPlugin';\n\nimport { HeadingNode, QuoteNode, $isQuoteNode, $createQuoteNode } from '@lexical/rich-text';\nimport { ListNode, ListItemNode } from '@lexical/list';\nimport { LinkNode, AutoLinkNode, $isLinkNode, TOGGLE_LINK_COMMAND } from '@lexical/link';\nimport {\n\tINSERT_ORDERED_LIST_COMMAND,\n\tINSERT_UNORDERED_LIST_COMMAND,\n\tREMOVE_LIST_COMMAND,\n\t$isListNode,\n} from '@lexical/list';\n\nimport { $generateHtmlFromNodes, $generateNodesFromDOM } from '@lexical/html';\nimport {\n\t$getRoot,\n\t$insertNodes,\n\t$getSelection,\n\t$isRangeSelection,\n\t$createParagraphNode,\n\tFORMAT_TEXT_COMMAND,\n\tSELECTION_CHANGE_COMMAND,\n\tCOMMAND_PRIORITY_CRITICAL,\n\tCOMMAND_PRIORITY_HIGH,\n\tCOMMAND_PRIORITY_EDITOR,\n\tcreateCommand,\n\tDecoratorNode,\n\tDRAGOVER_COMMAND,\n\tDROP_COMMAND,\n\tKEY_ENTER_COMMAND,\n\tKEY_ARROW_DOWN_COMMAND,\n\tKEY_ARROW_UP_COMMAND,\n\tKEY_ESCAPE_COMMAND,\n\tKEY_TAB_COMMAND,\n} from 'lexical';\nimport { $getNearestNodeOfType } from '@lexical/utils';\nimport { $setBlocksType } from '@lexical/selection';\n\n// ============================================================================\n// Image Node\n// ============================================================================\n\nconst INSERT_IMAGE_COMMAND = createCommand( 'INSERT_IMAGE_COMMAND' );\n\n/**\n * ImageNode - Custom Lexical node for displaying images.\n */\nclass ImageNode extends DecoratorNode {\n\t__src;\n\t__alt;\n\n\tstatic getType() {\n\t\treturn 'image';\n\t}\n\n\tstatic clone( node ) {\n\t\treturn new ImageNode( node.__src, node.__alt, node.__key );\n\t}\n\n\tconstructor( src, alt = '', key ) {\n\t\tsuper( key );\n\t\tthis.__src = src;\n\t\tthis.__alt = alt;\n\t}\n\n\tcreateDOM() {\n\t\tconst span = document.createElement( 'span' );\n\t\tspan.className = 'liveblog-lexical-image-wrapper';\n\t\treturn span;\n\t}\n\n\tupdateDOM() {\n\t\treturn false;\n\t}\n\n\tstatic importJSON( serializedNode ) {\n\t\tconst { src, alt } = serializedNode;\n\t\treturn $createImageNode( src, alt );\n\t}\n\n\texportJSON() {\n\t\treturn {\n\t\t\ttype: 'image',\n\t\t\tversion: 1,\n\t\t\tsrc: this.__src,\n\t\t\talt: this.__alt,\n\t\t};\n\t}\n\n\tstatic importDOM() {\n\t\treturn {\n\t\t\timg: () => ( {\n\t\t\t\tconversion: convertImageElement,\n\t\t\t\tpriority: 0,\n\t\t\t} ),\n\t\t};\n\t}\n\n\texportDOM() {\n\t\tconst img = document.createElement( 'img' );\n\t\timg.setAttribute( 'src', this.__src );\n\t\timg.setAttribute( 'alt', this.__alt );\n\t\treturn { element: img };\n\t}\n\n\tdecorate() {\n\t\treturn (\n\t\t\t<img\n\t\t\t\tsrc={ this.__src }\n\t\t\t\talt={ this.__alt }\n\t\t\t\tclassName=\"liveblog-lexical-image\"\n\t\t\t/>\n\t\t);\n\t}\n}\n\nfunction convertImageElement( domNode ) {\n\tif ( domNode instanceof HTMLImageElement ) {\n\t\tconst src = domNode.getAttribute( 'src' );\n\t\tconst alt = domNode.getAttribute( 'alt' ) || '';\n\t\tif ( src ) {\n\t\t\treturn { node: $createImageNode( src, alt ) };\n\t\t}\n\t}\n\treturn null;\n}\n\nfunction $createImageNode( src, alt = '' ) {\n\treturn new ImageNode( src, alt );\n}\n\nfunction $isImageNode( node ) {\n\treturn node instanceof ImageNode;\n}\n\n// ============================================================================\n// Theme\n// ============================================================================\n\nconst theme = {\n\tparagraph: 'liveblog-lexical-paragraph',\n\theading: {\n\t\th1: 'liveblog-lexical-h1',\n\t\th2: 'liveblog-lexical-h2',\n\t\th3: 'liveblog-lexical-h3',\n\t},\n\tlist: {\n\t\tul: 'liveblog-lexical-ul',\n\t\tol: 'liveblog-lexical-ol',\n\t\tlistitem: 'liveblog-lexical-li',\n\t\tnested: {\n\t\t\tlistitem: 'liveblog-lexical-li-nested',\n\t\t},\n\t},\n\ttext: {\n\t\tbold: 'liveblog-lexical-bold',\n\t\titalic: 'liveblog-lexical-italic',\n\t\tunderline: 'liveblog-lexical-underline',\n\t\tstrikethrough: 'liveblog-lexical-strikethrough',\n\t},\n\tlink: 'liveblog-lexical-link',\n\tquote: 'liveblog-lexical-quote',\n\timage: 'liveblog-lexical-image',\n};\n\n// Nodes to register with the editor\nconst nodes = [\n\tHeadingNode,\n\tQuoteNode,\n\tListNode,\n\tListItemNode,\n\tLinkNode,\n\tAutoLinkNode,\n\tImageNode,\n];\n\n// ============================================================================\n// Plugins\n// ============================================================================\n\n/**\n * Plugin to load initial HTML content into the editor.\n * Only loads content once on mount to avoid cursor position issues.\n */\nfunction InitialContentPlugin( { initialContent } ) {\n\tconst [ editor ] = useLexicalComposerContext();\n\tconst hasLoadedRef = useRef( false );\n\n\tuseEffect( () => {\n\t\t// Only load initial content once\n\t\tif ( hasLoadedRef.current || ! initialContent ) {\n\t\t\treturn;\n\t\t}\n\n\t\thasLoadedRef.current = true;\n\n\t\teditor.update( () => {\n\t\t\tconst parser = new DOMParser();\n\t\t\tconst dom = parser.parseFromString( initialContent, 'text/html' );\n\t\t\tconst generatedNodes = $generateNodesFromDOM( editor, dom );\n\n\t\t\tconst root = $getRoot();\n\t\t\troot.clear();\n\t\t\troot.select();\n\t\t\t$insertNodes( generatedNodes );\n\t\t} );\n\t}, [ editor, initialContent ] );\n\n\treturn null;\n}\n\n/**\n * Clean up Lexical's HTML output.\n * Removes unnecessary markup added by Lexical.\n *\n * @param {string} html - Raw HTML from Lexical.\n * @return {string} Cleaned HTML.\n */\nfunction cleanLexicalHtml( html ) {\n\tlet cleaned = html;\n\n\t// Remove style=\"white-space: pre-wrap;\" from any element\n\tcleaned = cleaned.replace( / style=\"white-space: pre-wrap;\"/g, '' );\n\n\t// Remove liveblog-lexical-* class attributes (not needed in stored HTML)\n\tcleaned = cleaned.replace( / class=\"liveblog-lexical-[^\"]*\"/g, '' );\n\n\t// Remove redundant <i> wrapping <em> (Lexical outputs both)\n\tcleaned = cleaned.replace( /<i>(<em[^>]*>)/g, '$1' );\n\tcleaned = cleaned.replace( /<\\/em><\\/i>/g, '</em>' );\n\n\t// Remove redundant <b> wrapping <strong>\n\tcleaned = cleaned.replace( /<b>(<strong[^>]*>)/g, '$1' );\n\tcleaned = cleaned.replace( /<\\/strong><\\/b>/g, '</strong>' );\n\n\t// Remove empty spans\n\tcleaned = cleaned.replace( /<span>([^<]*)<\\/span>/g, '$1' );\n\n\t// Clean up image wrapper spans\n\tcleaned = cleaned.replace( /<span class=\"liveblog-lexical-image-wrapper\">(<img[^>]*>)<\\/span>/g, '$1' );\n\n\treturn cleaned;\n}\n\n/**\n * Plugin to export HTML when content changes.\n */\nfunction HtmlExportPlugin( { onChange } ) {\n\tconst [ editor ] = useLexicalComposerContext();\n\n\tconst handleChange = useCallback(\n\t\t( editorState ) => {\n\t\t\tif ( ! onChange ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\teditorState.read( () => {\n\t\t\t\tconst rawHtml = $generateHtmlFromNodes( editor, null );\n\t\t\t\tconst html = cleanLexicalHtml( rawHtml );\n\t\t\t\tonChange( html );\n\t\t\t} );\n\t\t},\n\t\t[ editor, onChange ]\n\t);\n\n\treturn <OnChangePlugin onChange={ handleChange } />;\n}\n\n/**\n * Plugin to handle image insertion and drag-drop.\n */\nfunction ImagePlugin( { handleImageUpload } ) {\n\tconst [ editor ] = useLexicalComposerContext();\n\n\tuseEffect( () => {\n\t\t// Handle INSERT_IMAGE_COMMAND\n\t\tconst unregisterInsertImage = editor.registerCommand(\n\t\t\tINSERT_IMAGE_COMMAND,\n\t\t\t( payload ) => {\n\t\t\t\tconst { src, alt } = payload;\n\t\t\t\tconst imageNode = $createImageNode( src, alt );\n\n\t\t\t\tconst selection = $getSelection();\n\t\t\t\tif ( $isRangeSelection( selection ) ) {\n\t\t\t\t\tselection.insertNodes( [ imageNode ] );\n\t\t\t\t} else {\n\t\t\t\t\tconst root = $getRoot();\n\t\t\t\t\tconst paragraph = $createParagraphNode();\n\t\t\t\t\tparagraph.append( imageNode );\n\t\t\t\t\troot.append( paragraph );\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tCOMMAND_PRIORITY_EDITOR\n\t\t);\n\n\t\t// Handle drag over\n\t\tconst unregisterDragOver = editor.registerCommand(\n\t\t\tDRAGOVER_COMMAND,\n\t\t\t( event ) => {\n\t\t\t\tconst hasFiles = event.dataTransfer?.types?.includes( 'Files' );\n\t\t\t\tif ( hasFiles ) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tCOMMAND_PRIORITY_HIGH\n\t\t);\n\n\t\t// Handle drop\n\t\tconst unregisterDrop = editor.registerCommand(\n\t\t\tDROP_COMMAND,\n\t\t\t( event ) => {\n\t\t\t\tconst files = event.dataTransfer?.files;\n\t\t\t\tif ( files && files.length > 0 ) {\n\t\t\t\t\tconst file = files[ 0 ];\n\t\t\t\t\tif ( file.type.startsWith( 'image/' ) ) {\n\t\t\t\t\t\tevent.preventDefault();\n\n\t\t\t\t\t\tif ( handleImageUpload ) {\n\t\t\t\t\t\t\thandleImageUpload( file ).then( ( src ) => {\n\t\t\t\t\t\t\t\teditor.dispatchCommand( INSERT_IMAGE_COMMAND, {\n\t\t\t\t\t\t\t\t\tsrc,\n\t\t\t\t\t\t\t\t\talt: file.name,\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t} ).catch( ( err ) => {\n\t\t\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\t\t\tconsole.error( 'Image upload failed:', err );\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tCOMMAND_PRIORITY_HIGH\n\t\t);\n\n\t\treturn () => {\n\t\t\tunregisterInsertImage();\n\t\t\tunregisterDragOver();\n\t\t\tunregisterDrop();\n\t\t};\n\t}, [ editor, handleImageUpload ] );\n\n\treturn null;\n}\n\n// ============================================================================\n// Autocomplete Plugin\n// ============================================================================\n\nconst AUTOCOMPLETE_TRIGGERS = [ '@', '#', '/', ':' ];\n\n/**\n * Get the current trigger and search text from the selection.\n *\n * @param {Object} editor - Lexical editor instance.\n * @return {Object|null} Object with trigger and text, or null if no trigger found.\n */\nfunction getTriggerMatch( editor ) {\n\tlet result = null;\n\n\teditor.getEditorState().read( () => {\n\t\tconst selection = $getSelection();\n\t\tif ( ! $isRangeSelection( selection ) || ! selection.isCollapsed() ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst anchor = selection.anchor;\n\t\tconst anchorNode = anchor.getNode();\n\n\t\t// Only handle text nodes\n\t\tif ( anchorNode.getType() !== 'text' ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst textContent = anchorNode.getTextContent();\n\t\tconst offset = anchor.offset;\n\n\t\t// Look backwards from cursor to find a trigger\n\t\tfor ( let i = offset - 1; i >= 0; i-- ) {\n\t\t\tconst char = textContent[ i ];\n\n\t\t\t// Found a space before finding a trigger - no match\n\t\t\tif ( char === ' ' || char === '\\n' ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Found a trigger\n\t\t\tif ( AUTOCOMPLETE_TRIGGERS.includes( char ) ) {\n\t\t\t\t// Check if trigger is at start of text or preceded by space\n\t\t\t\tif ( i === 0 || textContent[ i - 1 ] === ' ' || textContent[ i - 1 ] === '\\n' ) {\n\t\t\t\t\tresult = {\n\t\t\t\t\t\ttrigger: char,\n\t\t\t\t\t\ttext: textContent.slice( i + 1, offset ),\n\t\t\t\t\t\tstartOffset: i,\n\t\t\t\t\t\tendOffset: offset,\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t} );\n\n\treturn result;\n}\n\n/**\n * Plugin to handle autocomplete suggestions.\n */\nfunction AutocompletePlugin( { suggestions, onSearch } ) {\n\tconst [ editor ] = useLexicalComposerContext();\n\tconst [ triggerMatch, setTriggerMatch ] = useState( null );\n\tconst [ selectedIndex, setSelectedIndex ] = useState( 0 );\n\tconst [ menuPosition, setMenuPosition ] = useState( { top: 0, left: 0 } );\n\tconst menuRef = useRef( null );\n\tconst triggerMatchRef = useRef( null );\n\tconst selectedIndexRef = useRef( 0 );\n\n\t// Keep refs in sync with state for use in command handlers\n\tuseEffect( () => {\n\t\ttriggerMatchRef.current = triggerMatch;\n\t}, [ triggerMatch ] );\n\n\tuseEffect( () => {\n\t\tselectedIndexRef.current = selectedIndex;\n\t}, [ selectedIndex ] );\n\n\t/**\n\t * Insert the selected suggestion into the editor.\n\t *\n\t * @param {Object|string} suggestion - The suggestion to insert.\n\t */\n\tconst selectSuggestion = useCallback( ( suggestion ) => {\n\t\tconst match = triggerMatchRef.current;\n\t\tif ( ! match ) {\n\t\t\treturn;\n\t\t}\n\n\t\teditor.update( () => {\n\t\t\tconst selection = $getSelection();\n\t\t\tif ( ! $isRangeSelection( selection ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst anchor = selection.anchor;\n\t\t\tconst anchorNode = anchor.getNode();\n\n\t\t\tif ( anchorNode.getType() !== 'text' ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst textContent = anchorNode.getTextContent();\n\t\t\tconst { trigger, startOffset, endOffset } = match;\n\n\t\t\t// Build replacement text based on trigger type\n\t\t\tlet replacementText;\n\n\t\t\tswitch ( trigger ) {\n\t\t\t\tcase '@':\n\t\t\t\t\t// Author mention - use key (user_nicename) for the @mention\n\t\t\t\t\t// Server-side PHP will convert @key to a link\n\t\t\t\t\treplacementText = suggestion.key\n\t\t\t\t\t\t? `@${ suggestion.key } `\n\t\t\t\t\t\t: `@${ suggestion } `;\n\t\t\t\t\tbreak;\n\t\t\t\tcase '#':\n\t\t\t\t\t// Hashtag - use name property\n\t\t\t\t\t// Server-side PHP will convert #hashtag to a link\n\t\t\t\t\treplacementText = suggestion.name\n\t\t\t\t\t\t? `#${ suggestion.name } `\n\t\t\t\t\t\t: `#${ suggestion } `;\n\t\t\t\t\tbreak;\n\t\t\t\tcase '/':\n\t\t\t\t\t// Command - insert the command text\n\t\t\t\t\treplacementText = suggestion + ' ';\n\t\t\t\t\tbreak;\n\t\t\t\tcase ':':\n\t\t\t\t\t// Emoji - insert :key: format (e.g., :smile:)\n\t\t\t\t\t// Server-side PHP will convert :key: to an emoji image\n\t\t\t\t\treplacementText = suggestion.key\n\t\t\t\t\t\t? `:${ suggestion.key }: `\n\t\t\t\t\t\t: `:${ suggestion }: `;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\treplacementText = suggestion + ' ';\n\t\t\t}\n\n\t\t\t// Replace the trigger + search text with the replacement\n\t\t\tconst beforeText = textContent.slice( 0, startOffset );\n\t\t\tconst afterText = textContent.slice( endOffset );\n\t\t\tconst newText = beforeText + replacementText + afterText;\n\n\t\t\t// Update the text node\n\t\t\tanchorNode.setTextContent( newText );\n\n\t\t\t// Move cursor to end of inserted text\n\t\t\tconst newOffset = startOffset + replacementText.length;\n\t\t\tselection.anchor.set( anchorNode.getKey(), newOffset, 'text' );\n\t\t\tselection.focus.set( anchorNode.getKey(), newOffset, 'text' );\n\t\t} );\n\n\t\tsetTriggerMatch( null );\n\t}, [ editor ] );\n\n\t// Register keyboard commands with Lexical\n\tuseEffect( () => {\n\t\tconst unregisterEnter = editor.registerCommand(\n\t\t\tKEY_ENTER_COMMAND,\n\t\t\t( event ) => {\n\t\t\t\tif ( triggerMatchRef.current && suggestions && suggestions.length > 0 ) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tselectSuggestion( suggestions[ selectedIndexRef.current ] );\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tCOMMAND_PRIORITY_HIGH\n\t\t);\n\n\t\tconst unregisterTab = editor.registerCommand(\n\t\t\tKEY_TAB_COMMAND,\n\t\t\t( event ) => {\n\t\t\t\tif ( triggerMatchRef.current && suggestions && suggestions.length > 0 ) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tselectSuggestion( suggestions[ selectedIndexRef.current ] );\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tCOMMAND_PRIORITY_HIGH\n\t\t);\n\n\t\tconst unregisterArrowDown = editor.registerCommand(\n\t\t\tKEY_ARROW_DOWN_COMMAND,\n\t\t\t( event ) => {\n\t\t\t\tif ( triggerMatchRef.current && suggestions && suggestions.length > 0 ) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tsetSelectedIndex( ( prev ) =>\n\t\t\t\t\t\tprev < suggestions.length - 1 ? prev + 1 : 0\n\t\t\t\t\t);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tCOMMAND_PRIORITY_HIGH\n\t\t);\n\n\t\tconst unregisterArrowUp = editor.registerCommand(\n\t\t\tKEY_ARROW_UP_COMMAND,\n\t\t\t( event ) => {\n\t\t\t\tif ( triggerMatchRef.current && suggestions && suggestions.length > 0 ) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tsetSelectedIndex( ( prev ) =>\n\t\t\t\t\t\tprev > 0 ? prev - 1 : suggestions.length - 1\n\t\t\t\t\t);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tCOMMAND_PRIORITY_HIGH\n\t\t);\n\n\t\tconst unregisterEscape = editor.registerCommand(\n\t\t\tKEY_ESCAPE_COMMAND,\n\t\t\t( event ) => {\n\t\t\t\tif ( triggerMatchRef.current ) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tsetTriggerMatch( null );\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tCOMMAND_PRIORITY_HIGH\n\t\t);\n\n\t\treturn () => {\n\t\t\tunregisterEnter();\n\t\t\tunregisterTab();\n\t\t\tunregisterArrowDown();\n\t\t\tunregisterArrowUp();\n\t\t\tunregisterEscape();\n\t\t};\n\t}, [ editor, suggestions, selectSuggestion ] );\n\n\t// Update trigger match when content changes\n\tuseEffect( () => {\n\t\treturn editor.registerUpdateListener( ( { editorState } ) => {\n\t\t\teditorState.read( () => {\n\t\t\t\tconst match = getTriggerMatch( editor );\n\t\t\t\tsetTriggerMatch( match );\n\n\t\t\t\tif ( match && onSearch ) {\n\t\t\t\t\tonSearch( match.trigger, match.text );\n\t\t\t\t}\n\n\t\t\t\t// Reset selection when match changes\n\t\t\t\tif ( match ) {\n\t\t\t\t\tsetSelectedIndex( 0 );\n\t\t\t\t}\n\t\t\t} );\n\t\t} );\n\t}, [ editor, onSearch ] );\n\n\t// Update menu position based on cursor\n\tuseEffect( () => {\n\t\tif ( ! triggerMatch ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst selection = window.getSelection();\n\t\tif ( selection && selection.rangeCount > 0 ) {\n\t\t\tconst range = selection.getRangeAt( 0 );\n\t\t\tconst rect = range.getBoundingClientRect();\n\n\t\t\t// Position below the cursor\n\t\t\tsetMenuPosition( {\n\t\t\t\ttop: rect.bottom + 4,\n\t\t\t\tleft: rect.left,\n\t\t\t} );\n\t\t}\n\t}, [ triggerMatch, suggestions ] );\n\n\t// Don't render if no trigger match or no suggestions\n\tif ( ! triggerMatch || ! suggestions || suggestions.length === 0 ) {\n\t\treturn null;\n\t}\n\n\treturn (\n\t\t<div\n\t\t\tref={ menuRef }\n\t\t\tclassName=\"liveblog-autocomplete-menu\"\n\t\t\tstyle={ {\n\t\t\t\tposition: 'fixed',\n\t\t\t\ttop: menuPosition.top,\n\t\t\t\tleft: menuPosition.left,\n\t\t\t\tzIndex: 1000,\n\t\t\t} }\n\t\t>\n\t\t\t<ul className=\"liveblog-autocomplete-list\">\n\t\t\t\t{ suggestions.map( ( suggestion, index ) => {\n\t\t\t\t\t// Handle different suggestion types\n\t\t\t\t\tlet displayText;\n\t\t\t\t\tlet avatarHtml = null;\n\n\t\t\t\t\tif ( typeof suggestion === 'string' ) {\n\t\t\t\t\t\tdisplayText = suggestion;\n\t\t\t\t\t} else if ( suggestion.image && suggestion.key ) {\n\t\t\t\t\t\t// Emoji - has image (unicode codepoint) and key (shortcode)\n\t\t\t\t\t\tdisplayText = `:${ suggestion.key }:`;\n\t\t\t\t\t} else if ( suggestion.name ) {\n\t\t\t\t\t\t// Author or hashtag\n\t\t\t\t\t\tdisplayText = suggestion.name;\n\t\t\t\t\t\t// Avatar is HTML string, not a URL\n\t\t\t\t\t\tif ( suggestion.avatar ) {\n\t\t\t\t\t\t\tavatarHtml = suggestion.avatar;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdisplayText = String( suggestion );\n\t\t\t\t\t}\n\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<li\n\t\t\t\t\t\t\tkey={ index }\n\t\t\t\t\t\t\tclassName={ `liveblog-autocomplete-item${\n\t\t\t\t\t\t\t\tindex === selectedIndex ? ' is-selected' : ''\n\t\t\t\t\t\t\t}` }\n\t\t\t\t\t\t\tonClick={ () => selectSuggestion( suggestion ) }\n\t\t\t\t\t\t\tonMouseEnter={ () => setSelectedIndex( index ) }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ avatarHtml && (\n\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\tclassName=\"liveblog-autocomplete-avatar\"\n\t\t\t\t\t\t\t\t\tdangerouslySetInnerHTML={ { __html: avatarHtml } }\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t<span className=\"liveblog-autocomplete-text\">\n\t\t\t\t\t\t\t\t{ displayText }\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t);\n\t\t\t\t} ) }\n\t\t\t</ul>\n\t\t</div>\n\t);\n}\n\nAutocompletePlugin.propTypes = {\n\tsuggestions: PropTypes.array,\n\tonSearch: PropTypes.func,\n};\n\n// ============================================================================\n// Toolbar Components\n// ============================================================================\n\n/**\n * Toolbar button component using Dashicons.\n */\nfunction ToolbarButton( { onClick, icon, title, isActive = false, disabled = false } ) {\n\treturn (\n\t\t<button\n\t\t\ttype=\"button\"\n\t\t\tonClick={ onClick }\n\t\t\ttitle={ title }\n\t\t\tclassName={ `liveblog-editor-btn${ isActive ? ' is-active' : '' }` }\n\t\t\tdisabled={ disabled }\n\t\t\taria-label={ title }\n\t\t>\n\t\t\t<span className={ `dashicons dashicons-${ icon }` } />\n\t\t</button>\n\t);\n}\n\nToolbarButton.propTypes = {\n\tonClick: PropTypes.func.isRequired,\n\ticon: PropTypes.string.isRequired,\n\ttitle: PropTypes.string.isRequired,\n\tisActive: PropTypes.bool,\n\tdisabled: PropTypes.bool,\n};\n\n/**\n * Link input modal component.\n */\nfunction LinkInput( { url, onChange, onConfirm, onCancel } ) {\n\treturn (\n\t\t<div className=\"liveblog-editor-input-container\">\n\t\t\t<input\n\t\t\t\tclassName=\"liveblog-input\"\n\t\t\t\ttype=\"url\"\n\t\t\t\tvalue={ url }\n\t\t\t\tonChange={ ( e ) => onChange( e.target.value ) }\n\t\t\t\tplaceholder=\"https://\"\n\t\t\t\t// eslint-disable-next-line jsx-a11y/no-autofocus\n\t\t\t\tautoFocus\n\t\t\t\tonKeyDown={ ( e ) => {\n\t\t\t\t\tif ( e.key === 'Enter' ) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tonConfirm();\n\t\t\t\t\t} else if ( e.key === 'Escape' ) {\n\t\t\t\t\t\tonCancel();\n\t\t\t\t\t}\n\t\t\t\t} }\n\t\t\t/>\n\t\t\t<button\n\t\t\t\ttype=\"button\"\n\t\t\t\tclassName=\"liveblog-editor-btn liveblog-input-enter\"\n\t\t\t\tonClick={ onConfirm }\n\t\t\t\ttitle=\"Add link\"\n\t\t\t>\n\t\t\t\t<span className=\"dashicons dashicons-yes\" />\n\t\t\t</button>\n\t\t\t<button\n\t\t\t\ttype=\"button\"\n\t\t\t\tclassName=\"liveblog-editor-btn liveblog-input-cancel\"\n\t\t\t\tonClick={ onCancel }\n\t\t\t\ttitle=\"Cancel\"\n\t\t\t>\n\t\t\t\t<span className=\"dashicons dashicons-no-alt\" />\n\t\t\t</button>\n\t\t</div>\n\t);\n}\n\nLinkInput.propTypes = {\n\turl: PropTypes.string.isRequired,\n\tonChange: PropTypes.func.isRequired,\n\tonConfirm: PropTypes.func.isRequired,\n\tonCancel: PropTypes.func.isRequired,\n};\n\n/**\n * Get the current selection state for toolbar active states.\n */\nfunction getSelectionState( editor ) {\n\tconst state = {\n\t\tisBold: false,\n\t\tisItalic: false,\n\t\tisUnderline: false,\n\t\tisLink: false,\n\t\tisQuote: false,\n\t\tlistType: null,\n\t};\n\n\teditor.getEditorState().read( () => {\n\t\tconst selection = $getSelection();\n\t\tif ( ! $isRangeSelection( selection ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tstate.isBold = selection.hasFormat( 'bold' );\n\t\tstate.isItalic = selection.hasFormat( 'italic' );\n\t\tstate.isUnderline = selection.hasFormat( 'underline' );\n\n\t\tconst anchorNode = selection.anchor.getNode();\n\t\tconst element = anchorNode.getKey() === 'root'\n\t\t\t? anchorNode\n\t\t\t: anchorNode.getTopLevelElementOrThrow();\n\n\t\t// Check for quote\n\t\tif ( $isQuoteNode( element ) ) {\n\t\t\tstate.isQuote = true;\n\t\t}\n\n\t\t// Check for list\n\t\tif ( $isListNode( element ) ) {\n\t\t\tstate.listType = element.getListType();\n\t\t} else {\n\t\t\tconst parent = anchorNode.getParent();\n\t\t\tif ( parent ) {\n\t\t\t\tconst listNode = $getNearestNodeOfType( parent, ListNode );\n\t\t\t\tif ( listNode ) {\n\t\t\t\t\tstate.listType = listNode.getListType();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Check for link\n\t\tconst node = selection.anchor.getNode();\n\t\tconst parent = node.getParent();\n\t\tstate.isLink = $isLinkNode( parent ) || $isLinkNode( node );\n\t} );\n\n\treturn state;\n}\n\n/**\n * Complete toolbar for text formatting.\n */\nfunction ToolbarPlugin( { readOnly, handleImageUpload } ) {\n\tconst [ editor ] = useLexicalComposerContext();\n\tconst [ selectionState, setSelectionState ] = useState( {\n\t\tisBold: false,\n\t\tisItalic: false,\n\t\tisUnderline: false,\n\t\tisLink: false,\n\t\tisQuote: false,\n\t\tlistType: null,\n\t} );\n\tconst [ showLinkInput, setShowLinkInput ] = useState( false );\n\tconst [ linkUrl, setLinkUrl ] = useState( 'https://' );\n\tconst [ isUploading, setIsUploading ] = useState( false );\n\tconst fileInputRef = useRef( null );\n\n\t// Update selection state when selection changes\n\tuseEffect( () => {\n\t\treturn editor.registerCommand(\n\t\t\tSELECTION_CHANGE_COMMAND,\n\t\t\t() => {\n\t\t\t\tsetSelectionState( getSelectionState( editor ) );\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tCOMMAND_PRIORITY_CRITICAL\n\t\t);\n\t}, [ editor ] );\n\n\tconst formatBold = useCallback( () => {\n\t\teditor.dispatchCommand( FORMAT_TEXT_COMMAND, 'bold' );\n\t}, [ editor ] );\n\n\tconst formatItalic = useCallback( () => {\n\t\teditor.dispatchCommand( FORMAT_TEXT_COMMAND, 'italic' );\n\t}, [ editor ] );\n\n\tconst formatUnderline = useCallback( () => {\n\t\teditor.dispatchCommand( FORMAT_TEXT_COMMAND, 'underline' );\n\t}, [ editor ] );\n\n\tconst formatOrderedList = useCallback( () => {\n\t\tif ( selectionState.listType === 'number' ) {\n\t\t\teditor.dispatchCommand( REMOVE_LIST_COMMAND, undefined );\n\t\t} else {\n\t\t\teditor.dispatchCommand( INSERT_ORDERED_LIST_COMMAND, undefined );\n\t\t}\n\t}, [ editor, selectionState.listType ] );\n\n\tconst formatUnorderedList = useCallback( () => {\n\t\tif ( selectionState.listType === 'bullet' ) {\n\t\t\teditor.dispatchCommand( REMOVE_LIST_COMMAND, undefined );\n\t\t} else {\n\t\t\teditor.dispatchCommand( INSERT_UNORDERED_LIST_COMMAND, undefined );\n\t\t}\n\t}, [ editor, selectionState.listType ] );\n\n\tconst formatQuote = useCallback( () => {\n\t\teditor.update( () => {\n\t\t\tconst selection = $getSelection();\n\t\t\tif ( ! $isRangeSelection( selection ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( selectionState.isQuote ) {\n\t\t\t\t// Remove quote - convert back to paragraph\n\t\t\t\t$setBlocksType( selection, () => $createParagraphNode() );\n\t\t\t} else {\n\t\t\t\t// Add quote\n\t\t\t\t$setBlocksType( selection, () => $createQuoteNode() );\n\t\t\t}\n\t\t} );\n\t}, [ editor, selectionState.isQuote ] );\n\n\tconst openLinkModal = useCallback( () => {\n\t\teditor.getEditorState().read( () => {\n\t\t\tconst selection = $getSelection();\n\t\t\tif ( ! $isRangeSelection( selection ) || selection.isCollapsed() ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Check if there's an existing link\n\t\t\tconst node = selection.anchor.getNode();\n\t\t\tconst parent = node.getParent();\n\t\t\tif ( $isLinkNode( parent ) ) {\n\t\t\t\tsetLinkUrl( parent.getURL() );\n\t\t\t} else if ( $isLinkNode( node ) ) {\n\t\t\t\tsetLinkUrl( node.getURL() );\n\t\t\t} else {\n\t\t\t\tsetLinkUrl( 'https://' );\n\t\t\t}\n\n\t\t\tsetShowLinkInput( true );\n\t\t} );\n\t}, [ editor ] );\n\n\tconst insertLink = useCallback( () => {\n\t\tif ( linkUrl && linkUrl !== 'https://' ) {\n\t\t\teditor.dispatchCommand( TOGGLE_LINK_COMMAND, linkUrl );\n\t\t}\n\t\tsetShowLinkInput( false );\n\t\tsetLinkUrl( 'https://' );\n\t}, [ editor, linkUrl ] );\n\n\tconst removeLink = useCallback( () => {\n\t\teditor.dispatchCommand( TOGGLE_LINK_COMMAND, null );\n\t\tsetShowLinkInput( false );\n\t}, [ editor ] );\n\n\tconst cancelLink = useCallback( () => {\n\t\tsetShowLinkInput( false );\n\t\tsetLinkUrl( 'https://' );\n\t}, [] );\n\n\tconst handleImageButtonClick = useCallback( () => {\n\t\tfileInputRef.current?.click();\n\t}, [] );\n\n\tconst handleFileSelect = useCallback( ( event ) => {\n\t\tconst file = event.target.files?.[ 0 ];\n\t\tif ( file && file.type.startsWith( 'image/' ) && handleImageUpload ) {\n\t\t\tsetIsUploading( true );\n\t\t\thandleImageUpload( file )\n\t\t\t\t.then( ( src ) => {\n\t\t\t\t\teditor.dispatchCommand( INSERT_IMAGE_COMMAND, {\n\t\t\t\t\t\tsrc,\n\t\t\t\t\t\talt: file.name,\n\t\t\t\t\t} );\n\t\t\t\t} )\n\t\t\t\t.catch( ( err ) => {\n\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\tconsole.error( 'Image upload failed:', err );\n\t\t\t\t} )\n\t\t\t\t.finally( () => {\n\t\t\t\t\tsetIsUploading( false );\n\t\t\t\t\t// Reset input so same file can be selected again\n\t\t\t\t\tif ( fileInputRef.current ) {\n\t\t\t\t\t\tfileInputRef.current.value = '';\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t}\n\t}, [ editor, handleImageUpload ] );\n\n\treturn (\n\t\t<div className=\"liveblog-editor-toolbar-container\">\n\t\t\t<div className=\"liveblog-toolbar\">\n\t\t\t\t<ToolbarButton\n\t\t\t\t\tonClick={ formatBold }\n\t\t\t\t\ticon=\"editor-bold\"\n\t\t\t\t\ttitle=\"Bold (Ctrl+B)\"\n\t\t\t\t\tisActive={ selectionState.isBold }\n\t\t\t\t\tdisabled={ readOnly }\n\t\t\t\t/>\n\t\t\t\t<ToolbarButton\n\t\t\t\t\tonClick={ formatItalic }\n\t\t\t\t\ticon=\"editor-italic\"\n\t\t\t\t\ttitle=\"Italic (Ctrl+I)\"\n\t\t\t\t\tisActive={ selectionState.isItalic }\n\t\t\t\t\tdisabled={ readOnly }\n\t\t\t\t/>\n\t\t\t\t<ToolbarButton\n\t\t\t\t\tonClick={ formatUnderline }\n\t\t\t\t\ticon=\"editor-underline\"\n\t\t\t\t\ttitle=\"Underline (Ctrl+U)\"\n\t\t\t\t\tisActive={ selectionState.isUnderline }\n\t\t\t\t\tdisabled={ readOnly }\n\t\t\t\t/>\n\t\t\t\t<ToolbarButton\n\t\t\t\t\tonClick={ formatOrderedList }\n\t\t\t\t\ticon=\"editor-ol\"\n\t\t\t\t\ttitle=\"Ordered List\"\n\t\t\t\t\tisActive={ selectionState.listType === 'number' }\n\t\t\t\t\tdisabled={ readOnly }\n\t\t\t\t/>\n\t\t\t\t<ToolbarButton\n\t\t\t\t\tonClick={ formatUnorderedList }\n\t\t\t\t\ticon=\"editor-ul\"\n\t\t\t\t\ttitle=\"Unordered List\"\n\t\t\t\t\tisActive={ selectionState.listType === 'bullet' }\n\t\t\t\t\tdisabled={ readOnly }\n\t\t\t\t/>\n\t\t\t\t<ToolbarButton\n\t\t\t\t\tonClick={ formatQuote }\n\t\t\t\t\ticon=\"format-quote\"\n\t\t\t\t\ttitle=\"Blockquote\"\n\t\t\t\t\tisActive={ selectionState.isQuote }\n\t\t\t\t\tdisabled={ readOnly }\n\t\t\t\t/>\n\t\t\t\t<div style={ { position: 'relative', display: 'inline-block' } }>\n\t\t\t\t\t<ToolbarButton\n\t\t\t\t\t\tonClick={ openLinkModal }\n\t\t\t\t\t\ticon=\"admin-links\"\n\t\t\t\t\t\ttitle=\"Add Link\"\n\t\t\t\t\t\tisActive={ selectionState.isLink }\n\t\t\t\t\t\tdisabled={ readOnly }\n\t\t\t\t\t/>\n\t\t\t\t\t{ showLinkInput && (\n\t\t\t\t\t\t<LinkInput\n\t\t\t\t\t\t\turl={ linkUrl }\n\t\t\t\t\t\t\tonChange={ setLinkUrl }\n\t\t\t\t\t\t\tonConfirm={ insertLink }\n\t\t\t\t\t\t\tonCancel={ cancelLink }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t</div>\n\t\t\t\t<ToolbarButton\n\t\t\t\t\tonClick={ removeLink }\n\t\t\t\t\ticon=\"editor-unlink\"\n\t\t\t\t\ttitle=\"Remove Link\"\n\t\t\t\t\tdisabled={ readOnly || ! selectionState.isLink }\n\t\t\t\t/>\n\t\t\t\t{ handleImageUpload && (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<ToolbarButton\n\t\t\t\t\t\t\tonClick={ handleImageButtonClick }\n\t\t\t\t\t\t\ticon=\"format-image\"\n\t\t\t\t\t\t\ttitle={ isUploading ? 'Uploading...' : 'Insert Image' }\n\t\t\t\t\t\t\tdisabled={ readOnly || isUploading }\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tref={ fileInputRef }\n\t\t\t\t\t\t\ttype=\"file\"\n\t\t\t\t\t\t\taccept=\"image/*\"\n\t\t\t\t\t\t\tonChange={ handleFileSelect }\n\t\t\t\t\t\t\tstyle={ { display: 'none' } }\n\t\t\t\t\t\t/>\n\t\t\t\t\t</>\n\t\t\t\t) }\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n\nToolbarPlugin.propTypes = {\n\treadOnly: PropTypes.bool,\n\thandleImageUpload: PropTypes.func,\n};\n\n// ============================================================================\n// Main Component\n// ============================================================================\n\n/**\n * Main Lexical Editor component.\n *\n * @param {Object}   props                   - Component props.\n * @param {string}   props.initialContent    - Initial HTML content to load.\n * @param {Function} props.onChange          - Callback when content changes, receives HTML string.\n * @param {boolean}  props.readOnly          - Whether the editor is read-only.\n * @param {Function} props.handleImageUpload - Function to handle image uploads.\n * @param {Array}    props.suggestions       - Autocomplete suggestions to display.\n * @param {Function} props.onSearch          - Callback when autocomplete trigger detected.\n */\nconst LexicalEditor = ( {\n\tinitialContent = '',\n\tonChange = null,\n\treadOnly = false,\n\thandleImageUpload = null,\n\tsuggestions = [],\n\tonSearch = null,\n} ) => {\n\tconst initialConfig = {\n\t\tnamespace: 'LiveblogEditor',\n\t\ttheme,\n\t\tnodes,\n\t\teditable: ! readOnly,\n\t\tonError: ( error ) => {\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.error( 'Lexical error:', error );\n\t\t},\n\t};\n\n\treturn (\n\t\t<div className=\"liveblog-lexical-editor\">\n\t\t\t<LexicalComposer initialConfig={ initialConfig }>\n\t\t\t\t<ToolbarPlugin readOnly={ readOnly } handleImageUpload={ handleImageUpload } />\n\t\t\t\t<div className=\"liveblog-lexical-editor-inner\">\n\t\t\t\t\t<RichTextPlugin\n\t\t\t\t\t\tcontentEditable={\n\t\t\t\t\t\t\t<ContentEditable className=\"liveblog-lexical-content-editable\" />\n\t\t\t\t\t\t}\n\t\t\t\t\t\tplaceholder={\n\t\t\t\t\t\t\t<div className=\"liveblog-lexical-placeholder\">\n\t\t\t\t\t\t\t\tStart writing your liveblog entry...\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t}\n\t\t\t\t\t\tErrorBoundary={ LexicalErrorBoundary }\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<HistoryPlugin />\n\t\t\t\t<LinkPlugin />\n\t\t\t\t<ListPlugin />\n\t\t\t\t<ImagePlugin handleImageUpload={ handleImageUpload } />\n\t\t\t\t<AutocompletePlugin\n\t\t\t\t\tsuggestions={ suggestions }\n\t\t\t\t\tonSearch={ onSearch }\n\t\t\t\t/>\n\t\t\t\t<InitialContentPlugin initialContent={ initialContent } />\n\t\t\t\t<HtmlExportPlugin onChange={ onChange } />\n\t\t\t</LexicalComposer>\n\t\t</div>\n\t);\n};\n\nLexicalEditor.propTypes = {\n\tinitialContent: PropTypes.string,\n\tonChange: PropTypes.func,\n\treadOnly: PropTypes.bool,\n\thandleImageUpload: PropTypes.func,\n\tsuggestions: PropTypes.array,\n\tonSearch: PropTypes.func,\n};\n\nexport default LexicalEditor;\n"],"names":["INSERT_IMAGE_COMMAND","createCommand","ImageNode","DecoratorNode","__src","__alt","getType","clone","node","__key","constructor","src","alt","key","super","this","createDOM","span","document","createElement","className","updateDOM","importJSON","serializedNode","$createImageNode","exportJSON","type","version","importDOM","img","conversion","convertImageElement","priority","exportDOM","setAttribute","element","decorate","_jsx","domNode","HTMLImageElement","getAttribute","theme","paragraph","heading","h1","h2","h3","list","ul","ol","listitem","nested","text","bold","italic","underline","strikethrough","link","quote","image","nodes","HeadingNode","QuoteNode","ListNode","ListItemNode","LinkNode","AutoLinkNode","InitialContentPlugin","initialContent","editor","useLexicalComposerContext","hasLoadedRef","useRef","useEffect","current","update","dom","DOMParser","parseFromString","generatedNodes","$generateNodesFromDOM","root","$getRoot","clear","select","$insertNodes","HtmlExportPlugin","onChange","handleChange","useCallback","editorState","read","html","cleaned","replace","cleanLexicalHtml","$generateHtmlFromNodes","OnChangePlugin","ImagePlugin","handleImageUpload","unregisterInsertImage","registerCommand","payload","imageNode","selection","$getSelection","$isRangeSelection","insertNodes","$createParagraphNode","append","COMMAND_PRIORITY_EDITOR","unregisterDragOver","DRAGOVER_COMMAND","event","hasFiles","dataTransfer","types","includes","preventDefault","COMMAND_PRIORITY_HIGH","unregisterDrop","DROP_COMMAND","files","length","file","startsWith","then","dispatchCommand","name","catch","err","console","error","AUTOCOMPLETE_TRIGGERS","AutocompletePlugin","suggestions","onSearch","triggerMatch","setTriggerMatch","useState","selectedIndex","setSelectedIndex","menuPosition","setMenuPosition","top","left","menuRef","triggerMatchRef","selectedIndexRef","selectSuggestion","suggestion","match","anchorNode","anchor","getNode","textContent","getTextContent","trigger","startOffset","endOffset","replacementText","newText","slice","setTextContent","newOffset","set","getKey","focus","unregisterEnter","KEY_ENTER_COMMAND","unregisterTab","KEY_TAB_COMMAND","unregisterArrowDown","KEY_ARROW_DOWN_COMMAND","prev","unregisterArrowUp","KEY_ARROW_UP_COMMAND","unregisterEscape","KEY_ESCAPE_COMMAND","registerUpdateListener","result","getEditorState","isCollapsed","offset","i","char","getTriggerMatch","window","getSelection","rangeCount","rect","getRangeAt","getBoundingClientRect","bottom","ref","style","position","zIndex","children","map","index","displayText","avatarHtml","avatar","String","_jsxs","onClick","onMouseEnter","dangerouslySetInnerHTML","__html","ToolbarButton","icon","title","isActive","disabled","LinkInput","url","onConfirm","onCancel","value","e","target","placeholder","autoFocus","onKeyDown","ToolbarPlugin","readOnly","selectionState","setSelectionState","isBold","isItalic","isUnderline","isLink","isQuote","listType","showLinkInput","setShowLinkInput","linkUrl","setLinkUrl","isUploading","setIsUploading","fileInputRef","SELECTION_CHANGE_COMMAND","state","hasFormat","getTopLevelElementOrThrow","$isQuoteNode","$isListNode","getListType","parent","getParent","listNode","$getNearestNodeOfType","$isLinkNode","getSelectionState","COMMAND_PRIORITY_CRITICAL","formatBold","FORMAT_TEXT_COMMAND","formatItalic","formatUnderline","formatOrderedList","REMOVE_LIST_COMMAND","undefined","INSERT_ORDERED_LIST_COMMAND","formatUnorderedList","INSERT_UNORDERED_LIST_COMMAND","formatQuote","$setBlocksType","$createQuoteNode","openLinkModal","getURL","insertLink","TOGGLE_LINK_COMMAND","removeLink","cancelLink","handleImageButtonClick","click","handleFileSelect","finally","display","_Fragment","accept","propTypes","PropTypes","isRequired","LexicalEditor","initialConfig","namespace","editable","onError","LexicalComposer","RichTextPlugin","contentEditable","ContentEditable","ErrorBoundary","LexicalErrorBoundary","HistoryPlugin","LinkPlugin","ListPlugin"],"ignoreList":[],"sourceRoot":""}