{"version":3,"file":"749.bundle.js","mappings":"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","sources":["webpack://liveblog/./src/react/Editor/LexicalEditor.js"],"sourcesContent":["/**\n * LexicalEditor - Production implementation using Lexical\n *\n * Lexical is the official successor to Draft.js from the same team at Meta.\n *\n * @see https://lexical.dev/\n */\n\nimport React, { useEffect, useCallback, useRef, useState } from 'react';\nimport PropTypes from 'prop-types';\n\nimport { LexicalComposer } from '@lexical/react/LexicalComposer';\nimport { RichTextPlugin } from '@lexical/react/LexicalRichTextPlugin';\nimport { ContentEditable } from '@lexical/react/LexicalContentEditable';\nimport { HistoryPlugin } from '@lexical/react/LexicalHistoryPlugin';\nimport { OnChangePlugin } from '@lexical/react/LexicalOnChangePlugin';\nimport { useLexicalComposerContext } from '@lexical/react/LexicalComposerContext';\nimport { LexicalErrorBoundary } from '@lexical/react/LexicalErrorBoundary';\nimport { LinkPlugin } from '@lexical/react/LexicalLinkPlugin';\nimport { ListPlugin } from '@lexical/react/LexicalListPlugin';\n\nimport { HeadingNode, QuoteNode, $isQuoteNode, $createQuoteNode } from '@lexical/rich-text';\nimport { ListNode, ListItemNode } from '@lexical/list';\nimport { LinkNode, AutoLinkNode, $isLinkNode, TOGGLE_LINK_COMMAND } from '@lexical/link';\nimport {\n\tINSERT_ORDERED_LIST_COMMAND,\n\tINSERT_UNORDERED_LIST_COMMAND,\n\tREMOVE_LIST_COMMAND,\n\t$isListNode,\n} from '@lexical/list';\n\nimport { $generateHtmlFromNodes, $generateNodesFromDOM } from '@lexical/html';\nimport {\n\t$getRoot,\n\t$insertNodes,\n\t$getSelection,\n\t$isRangeSelection,\n\t$createParagraphNode,\n\tFORMAT_TEXT_COMMAND,\n\tSELECTION_CHANGE_COMMAND,\n\tCOMMAND_PRIORITY_CRITICAL,\n\tCOMMAND_PRIORITY_HIGH,\n\tCOMMAND_PRIORITY_EDITOR,\n\tcreateCommand,\n\tDecoratorNode,\n\tDRAGOVER_COMMAND,\n\tDROP_COMMAND,\n\tKEY_ENTER_COMMAND,\n\tKEY_ARROW_DOWN_COMMAND,\n\tKEY_ARROW_UP_COMMAND,\n\tKEY_ESCAPE_COMMAND,\n\tKEY_TAB_COMMAND,\n} from 'lexical';\nimport { $getNearestNodeOfType } from '@lexical/utils';\nimport { $setBlocksType } from '@lexical/selection';\n\n// ============================================================================\n// Image Node\n// ============================================================================\n\nconst INSERT_IMAGE_COMMAND = createCommand( 'INSERT_IMAGE_COMMAND' );\n\n/**\n * ImageNode - Custom Lexical node for displaying images.\n * Preserves all attributes from the original <img> element for flexible rendering.\n */\nclass ImageNode extends DecoratorNode {\n\t__src;\n\t__alt;\n\t__attributes;\n\n\tstatic getType() {\n\t\treturn 'image';\n\t}\n\n\tstatic clone( node ) {\n\t\treturn new ImageNode( node.__src, node.__alt, node.__attributes, node.__key );\n\t}\n\n\tconstructor( src, alt = '', attributes = {}, key ) {\n\t\tsuper( key );\n\t\tthis.__src = src;\n\t\tthis.__alt = alt;\n\t\t// Store all attributes, ensuring src and alt are always present\n\t\tthis.__attributes = { ...attributes, src, alt };\n\t}\n\n\tcreateDOM() {\n\t\tconst span = document.createElement( 'span' );\n\t\tspan.className = 'liveblog-lexical-image-wrapper';\n\t\treturn span;\n\t}\n\n\tupdateDOM() {\n\t\treturn false;\n\t}\n\n\tstatic importJSON( serializedNode ) {\n\t\tconst { src, alt, attributes = {} } = serializedNode;\n\t\treturn $createImageNode( src, alt, attributes );\n\t}\n\n\texportJSON() {\n\t\treturn {\n\t\t\ttype: 'image',\n\t\t\tversion: 1,\n\t\t\tsrc: this.__src,\n\t\t\talt: this.__alt,\n\t\t\tattributes: this.__attributes,\n\t\t};\n\t}\n\n\tstatic importDOM() {\n\t\treturn {\n\t\t\timg: () => ( {\n\t\t\t\tconversion: convertImageElement,\n\t\t\t\tpriority: 0,\n\t\t\t} ),\n\t\t};\n\t}\n\n\texportDOM() {\n\t\tconst img = document.createElement( 'img' );\n\t\t// Export all stored attributes\n\t\tObject.entries( this.__attributes ).forEach( ( [ key, value ] ) => {\n\t\t\tif ( value !== null && value !== undefined && value !== '' ) {\n\t\t\t\timg.setAttribute( key, value );\n\t\t\t}\n\t\t} );\n\t\treturn { element: img };\n\t}\n\n\tdecorate() {\n\t\t// Editor display uses only src and alt for simplicity\n\t\treturn (\n\t\t\t<img\n\t\t\t\tsrc={ this.__src }\n\t\t\t\talt={ this.__alt }\n\t\t\t\tclassName=\"liveblog-lexical-image\"\n\t\t\t/>\n\t\t);\n\t}\n}\n\nfunction convertImageElement( domNode ) {\n\tif ( domNode instanceof HTMLImageElement ) {\n\t\tconst src = domNode.getAttribute( 'src' );\n\t\tif ( src ) {\n\t\t\t// Collect all attributes from the original element\n\t\t\tconst attributes = {};\n\t\t\tfor ( const attr of domNode.attributes ) {\n\t\t\t\tattributes[ attr.name ] = attr.value;\n\t\t\t}\n\t\t\tconst alt = attributes.alt || '';\n\t\t\treturn { node: $createImageNode( src, alt, attributes ) };\n\t\t}\n\t}\n\treturn null;\n}\n\nfunction $createImageNode( src, alt = '', attributes = {} ) {\n\treturn new ImageNode( src, alt, attributes );\n}\n\nfunction $isImageNode( node ) {\n\treturn node instanceof ImageNode;\n}\n\n// ============================================================================\n// Theme\n// ============================================================================\n\nconst theme = {\n\tparagraph: 'liveblog-lexical-paragraph',\n\theading: {\n\t\th1: 'liveblog-lexical-h1',\n\t\th2: 'liveblog-lexical-h2',\n\t\th3: 'liveblog-lexical-h3',\n\t},\n\tlist: {\n\t\tul: 'liveblog-lexical-ul',\n\t\tol: 'liveblog-lexical-ol',\n\t\tlistitem: 'liveblog-lexical-li',\n\t\tnested: {\n\t\t\tlistitem: 'liveblog-lexical-li-nested',\n\t\t},\n\t},\n\ttext: {\n\t\tbold: 'liveblog-lexical-bold',\n\t\titalic: 'liveblog-lexical-italic',\n\t\tunderline: 'liveblog-lexical-underline',\n\t\tstrikethrough: 'liveblog-lexical-strikethrough',\n\t},\n\tlink: 'liveblog-lexical-link',\n\tquote: 'liveblog-lexical-quote',\n\timage: 'liveblog-lexical-image',\n};\n\n// Nodes to register with the editor\nconst nodes = [\n\tHeadingNode,\n\tQuoteNode,\n\tListNode,\n\tListItemNode,\n\tLinkNode,\n\tAutoLinkNode,\n\tImageNode,\n];\n\n// ============================================================================\n// Plugins\n// ============================================================================\n\n/**\n * Plugin to load initial HTML content into the editor.\n * Only loads content once on mount to avoid cursor position issues.\n */\nfunction InitialContentPlugin( { initialContent } ) {\n\tconst [ editor ] = useLexicalComposerContext();\n\tconst hasLoadedRef = useRef( false );\n\n\tuseEffect( () => {\n\t\t// Only load initial content once\n\t\tif ( hasLoadedRef.current || ! initialContent ) {\n\t\t\treturn;\n\t\t}\n\n\t\thasLoadedRef.current = true;\n\n\t\teditor.update( () => {\n\t\t\tconst parser = new DOMParser();\n\t\t\tconst dom = parser.parseFromString( initialContent, 'text/html' );\n\t\t\tconst generatedNodes = $generateNodesFromDOM( editor, dom );\n\n\t\t\tconst root = $getRoot();\n\t\t\troot.clear();\n\t\t\troot.select();\n\t\t\t$insertNodes( generatedNodes );\n\t\t} );\n\t}, [ editor, initialContent ] );\n\n\treturn null;\n}\n\n/**\n * Clean up Lexical's HTML output.\n * Removes unnecessary markup added by Lexical.\n *\n * @param {string} html - Raw HTML from Lexical.\n * @return {string} Cleaned HTML.\n */\nfunction cleanLexicalHtml( html ) {\n\tlet cleaned = html;\n\n\t// Remove style=\"white-space: pre-wrap;\" from any element\n\tcleaned = cleaned.replace( / style=\"white-space: pre-wrap;\"/g, '' );\n\n\t// Remove liveblog-lexical-* class attributes (not needed in stored HTML)\n\tcleaned = cleaned.replace( / class=\"liveblog-lexical-[^\"]*\"/g, '' );\n\n\t// Remove redundant <i> wrapping <em> (Lexical outputs both)\n\tcleaned = cleaned.replace( /<i>(<em[^>]*>)/g, '$1' );\n\tcleaned = cleaned.replace( /<\\/em><\\/i>/g, '</em>' );\n\n\t// Remove redundant <b> wrapping <strong>\n\tcleaned = cleaned.replace( /<b>(<strong[^>]*>)/g, '$1' );\n\tcleaned = cleaned.replace( /<\\/strong><\\/b>/g, '</strong>' );\n\n\t// Remove empty spans\n\tcleaned = cleaned.replace( /<span>([^<]*)<\\/span>/g, '$1' );\n\n\t// Clean up image wrapper spans\n\tcleaned = cleaned.replace( /<span class=\"liveblog-lexical-image-wrapper\">(<img[^>]*>)<\\/span>/g, '$1' );\n\n\treturn cleaned;\n}\n\n/**\n * Plugin to export HTML when content changes.\n */\nfunction HtmlExportPlugin( { onChange } ) {\n\tconst [ editor ] = useLexicalComposerContext();\n\n\tconst handleChange = useCallback(\n\t\t( editorState ) => {\n\t\t\tif ( ! onChange ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\teditorState.read( () => {\n\t\t\t\tconst rawHtml = $generateHtmlFromNodes( editor, null );\n\t\t\t\tconst html = cleanLexicalHtml( rawHtml );\n\t\t\t\tonChange( html );\n\t\t\t} );\n\t\t},\n\t\t[ editor, onChange ]\n\t);\n\n\treturn <OnChangePlugin onChange={ handleChange } />;\n}\n\n/**\n * Plugin to handle image insertion and drag-drop.\n */\nfunction ImagePlugin( { handleImageUpload } ) {\n\tconst [ editor ] = useLexicalComposerContext();\n\n\tuseEffect( () => {\n\t\t// Handle INSERT_IMAGE_COMMAND\n\t\tconst unregisterInsertImage = editor.registerCommand(\n\t\t\tINSERT_IMAGE_COMMAND,\n\t\t\t( payload ) => {\n\t\t\t\tconst { src, alt } = payload;\n\t\t\t\tconst imageNode = $createImageNode( src, alt );\n\n\t\t\t\tconst selection = $getSelection();\n\t\t\t\tif ( $isRangeSelection( selection ) ) {\n\t\t\t\t\tselection.insertNodes( [ imageNode ] );\n\t\t\t\t} else {\n\t\t\t\t\tconst root = $getRoot();\n\t\t\t\t\tconst paragraph = $createParagraphNode();\n\t\t\t\t\tparagraph.append( imageNode );\n\t\t\t\t\troot.append( paragraph );\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tCOMMAND_PRIORITY_EDITOR\n\t\t);\n\n\t\t// Handle drag over\n\t\tconst unregisterDragOver = editor.registerCommand(\n\t\t\tDRAGOVER_COMMAND,\n\t\t\t( event ) => {\n\t\t\t\tconst hasFiles = event.dataTransfer?.types?.includes( 'Files' );\n\t\t\t\tif ( hasFiles ) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tCOMMAND_PRIORITY_HIGH\n\t\t);\n\n\t\t// Handle drop\n\t\tconst unregisterDrop = editor.registerCommand(\n\t\t\tDROP_COMMAND,\n\t\t\t( event ) => {\n\t\t\t\tconst files = event.dataTransfer?.files;\n\t\t\t\tif ( files && files.length > 0 ) {\n\t\t\t\t\t// Filter to only image files\n\t\t\t\t\tconst imageFiles = Array.from( files ).filter( ( file ) =>\n\t\t\t\t\t\tfile.type.startsWith( 'image/' )\n\t\t\t\t\t);\n\n\t\t\t\t\tif ( imageFiles.length > 0 ) {\n\t\t\t\t\t\tevent.preventDefault();\n\n\t\t\t\t\t\tif ( handleImageUpload ) {\n\t\t\t\t\t\t\t// Upload all images sequentially to maintain order\n\t\t\t\t\t\t\timageFiles.reduce( ( promise, file ) => {\n\t\t\t\t\t\t\t\treturn promise.then( () =>\n\t\t\t\t\t\t\t\t\thandleImageUpload( file ).then( ( src ) => {\n\t\t\t\t\t\t\t\t\t\teditor.dispatchCommand( INSERT_IMAGE_COMMAND, {\n\t\t\t\t\t\t\t\t\t\t\tsrc,\n\t\t\t\t\t\t\t\t\t\t\talt: file.name,\n\t\t\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t\t\t} ).catch( ( err ) => {\n\t\t\t\t\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\t\t\t\t\tconsole.error( 'Image upload failed:', err );\n\t\t\t\t\t\t\t\t\t} )\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}, Promise.resolve() );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tCOMMAND_PRIORITY_HIGH\n\t\t);\n\n\t\treturn () => {\n\t\t\tunregisterInsertImage();\n\t\t\tunregisterDragOver();\n\t\t\tunregisterDrop();\n\t\t};\n\t}, [ editor, handleImageUpload ] );\n\n\treturn null;\n}\n\n// ============================================================================\n// Autocomplete Plugin\n// ============================================================================\n\nconst AUTOCOMPLETE_TRIGGERS = [ '@', '#', '/', ':' ];\n\n/**\n * Get the current trigger and search text from the selection.\n *\n * @param {Object} editor - Lexical editor instance.\n * @return {Object|null} Object with trigger and text, or null if no trigger found.\n */\nfunction getTriggerMatch( editor ) {\n\tlet result = null;\n\n\teditor.getEditorState().read( () => {\n\t\tconst selection = $getSelection();\n\t\tif ( ! $isRangeSelection( selection ) || ! selection.isCollapsed() ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst anchor = selection.anchor;\n\t\tconst anchorNode = anchor.getNode();\n\n\t\t// Only handle text nodes\n\t\tif ( anchorNode.getType() !== 'text' ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst textContent = anchorNode.getTextContent();\n\t\tconst offset = anchor.offset;\n\n\t\t// Look backwards from cursor to find a trigger\n\t\tfor ( let i = offset - 1; i >= 0; i-- ) {\n\t\t\tconst char = textContent[ i ];\n\n\t\t\t// Found a space before finding a trigger - no match\n\t\t\tif ( char === ' ' || char === '\\n' ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Found a trigger\n\t\t\tif ( AUTOCOMPLETE_TRIGGERS.includes( char ) ) {\n\t\t\t\t// Check if trigger is at start of text or preceded by space\n\t\t\t\tif ( i === 0 || textContent[ i - 1 ] === ' ' || textContent[ i - 1 ] === '\\n' ) {\n\t\t\t\t\tresult = {\n\t\t\t\t\t\ttrigger: char,\n\t\t\t\t\t\ttext: textContent.slice( i + 1, offset ),\n\t\t\t\t\t\tstartOffset: i,\n\t\t\t\t\t\tendOffset: offset,\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t} );\n\n\treturn result;\n}\n\n/**\n * Plugin to handle autocomplete suggestions.\n */\nfunction AutocompletePlugin( { suggestions, onSearch } ) {\n\tconst [ editor ] = useLexicalComposerContext();\n\tconst [ triggerMatch, setTriggerMatch ] = useState( null );\n\tconst [ selectedIndex, setSelectedIndex ] = useState( 0 );\n\tconst [ menuPosition, setMenuPosition ] = useState( { top: 0, left: 0 } );\n\tconst menuRef = useRef( null );\n\tconst triggerMatchRef = useRef( null );\n\tconst selectedIndexRef = useRef( 0 );\n\n\t// Keep refs in sync with state for use in command handlers\n\tuseEffect( () => {\n\t\ttriggerMatchRef.current = triggerMatch;\n\t}, [ triggerMatch ] );\n\n\tuseEffect( () => {\n\t\tselectedIndexRef.current = selectedIndex;\n\t}, [ selectedIndex ] );\n\n\t/**\n\t * Insert the selected suggestion into the editor.\n\t *\n\t * @param {Object|string} suggestion - The suggestion to insert.\n\t */\n\tconst selectSuggestion = useCallback( ( suggestion ) => {\n\t\tconst match = triggerMatchRef.current;\n\t\tif ( ! match ) {\n\t\t\treturn;\n\t\t}\n\n\t\teditor.update( () => {\n\t\t\tconst selection = $getSelection();\n\t\t\tif ( ! $isRangeSelection( selection ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst anchor = selection.anchor;\n\t\t\tconst anchorNode = anchor.getNode();\n\n\t\t\tif ( anchorNode.getType() !== 'text' ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst textContent = anchorNode.getTextContent();\n\t\t\tconst { trigger, startOffset, endOffset } = match;\n\n\t\t\t// Build replacement text based on trigger type\n\t\t\tlet replacementText;\n\n\t\t\tswitch ( trigger ) {\n\t\t\t\tcase '@':\n\t\t\t\t\t// Author mention - use key (user_nicename) for the @mention\n\t\t\t\t\t// Server-side PHP will convert @key to a link\n\t\t\t\t\treplacementText = suggestion.key\n\t\t\t\t\t\t? `@${ suggestion.key } `\n\t\t\t\t\t\t: `@${ suggestion } `;\n\t\t\t\t\tbreak;\n\t\t\t\tcase '#':\n\t\t\t\t\t// Hashtag - use name property\n\t\t\t\t\t// Server-side PHP will convert #hashtag to a link\n\t\t\t\t\treplacementText = suggestion.name\n\t\t\t\t\t\t? `#${ suggestion.name } `\n\t\t\t\t\t\t: `#${ suggestion } `;\n\t\t\t\t\tbreak;\n\t\t\t\tcase '/':\n\t\t\t\t\t// Command - insert the command text\n\t\t\t\t\treplacementText = suggestion + ' ';\n\t\t\t\t\tbreak;\n\t\t\t\tcase ':':\n\t\t\t\t\t// Emoji - insert :key: format (e.g., :smile:)\n\t\t\t\t\t// Server-side PHP will convert :key: to an emoji image\n\t\t\t\t\treplacementText = suggestion.key\n\t\t\t\t\t\t? `:${ suggestion.key }: `\n\t\t\t\t\t\t: `:${ suggestion }: `;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\treplacementText = suggestion + ' ';\n\t\t\t}\n\n\t\t\t// Replace the trigger + search text with the replacement\n\t\t\tconst beforeText = textContent.slice( 0, startOffset );\n\t\t\tconst afterText = textContent.slice( endOffset );\n\t\t\tconst newText = beforeText + replacementText + afterText;\n\n\t\t\t// Update the text node\n\t\t\tanchorNode.setTextContent( newText );\n\n\t\t\t// Move cursor to end of inserted text\n\t\t\tconst newOffset = startOffset + replacementText.length;\n\t\t\tselection.anchor.set( anchorNode.getKey(), newOffset, 'text' );\n\t\t\tselection.focus.set( anchorNode.getKey(), newOffset, 'text' );\n\t\t} );\n\n\t\tsetTriggerMatch( null );\n\t}, [ editor ] );\n\n\t// Register keyboard commands with Lexical\n\tuseEffect( () => {\n\t\tconst unregisterEnter = editor.registerCommand(\n\t\t\tKEY_ENTER_COMMAND,\n\t\t\t( event ) => {\n\t\t\t\tif ( triggerMatchRef.current && suggestions && suggestions.length > 0 ) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tselectSuggestion( suggestions[ selectedIndexRef.current ] );\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tCOMMAND_PRIORITY_HIGH\n\t\t);\n\n\t\tconst unregisterTab = editor.registerCommand(\n\t\t\tKEY_TAB_COMMAND,\n\t\t\t( event ) => {\n\t\t\t\tif ( triggerMatchRef.current && suggestions && suggestions.length > 0 ) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tselectSuggestion( suggestions[ selectedIndexRef.current ] );\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tCOMMAND_PRIORITY_HIGH\n\t\t);\n\n\t\tconst unregisterArrowDown = editor.registerCommand(\n\t\t\tKEY_ARROW_DOWN_COMMAND,\n\t\t\t( event ) => {\n\t\t\t\tif ( triggerMatchRef.current && suggestions && suggestions.length > 0 ) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tsetSelectedIndex( ( prev ) =>\n\t\t\t\t\t\tprev < suggestions.length - 1 ? prev + 1 : 0\n\t\t\t\t\t);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tCOMMAND_PRIORITY_HIGH\n\t\t);\n\n\t\tconst unregisterArrowUp = editor.registerCommand(\n\t\t\tKEY_ARROW_UP_COMMAND,\n\t\t\t( event ) => {\n\t\t\t\tif ( triggerMatchRef.current && suggestions && suggestions.length > 0 ) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tsetSelectedIndex( ( prev ) =>\n\t\t\t\t\t\tprev > 0 ? prev - 1 : suggestions.length - 1\n\t\t\t\t\t);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tCOMMAND_PRIORITY_HIGH\n\t\t);\n\n\t\tconst unregisterEscape = editor.registerCommand(\n\t\t\tKEY_ESCAPE_COMMAND,\n\t\t\t( event ) => {\n\t\t\t\tif ( triggerMatchRef.current ) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tsetTriggerMatch( null );\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tCOMMAND_PRIORITY_HIGH\n\t\t);\n\n\t\treturn () => {\n\t\t\tunregisterEnter();\n\t\t\tunregisterTab();\n\t\t\tunregisterArrowDown();\n\t\t\tunregisterArrowUp();\n\t\t\tunregisterEscape();\n\t\t};\n\t}, [ editor, suggestions, selectSuggestion ] );\n\n\t// Update trigger match when content changes\n\tuseEffect( () => {\n\t\treturn editor.registerUpdateListener( ( { editorState } ) => {\n\t\t\teditorState.read( () => {\n\t\t\t\tconst match = getTriggerMatch( editor );\n\t\t\t\tsetTriggerMatch( match );\n\n\t\t\t\tif ( match && onSearch ) {\n\t\t\t\t\tonSearch( match.trigger, match.text );\n\t\t\t\t}\n\n\t\t\t\t// Reset selection when match changes\n\t\t\t\tif ( match ) {\n\t\t\t\t\tsetSelectedIndex( 0 );\n\t\t\t\t}\n\t\t\t} );\n\t\t} );\n\t}, [ editor, onSearch ] );\n\n\t// Update menu position based on cursor\n\tuseEffect( () => {\n\t\tif ( ! triggerMatch ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst selection = window.getSelection();\n\t\tif ( selection && selection.rangeCount > 0 ) {\n\t\t\tconst range = selection.getRangeAt( 0 );\n\t\t\tconst rect = range.getBoundingClientRect();\n\n\t\t\t// Position below the cursor\n\t\t\tsetMenuPosition( {\n\t\t\t\ttop: rect.bottom + 4,\n\t\t\t\tleft: rect.left,\n\t\t\t} );\n\t\t}\n\t}, [ triggerMatch, suggestions ] );\n\n\t// Don't render if no trigger match or no suggestions\n\tif ( ! triggerMatch || ! suggestions || suggestions.length === 0 ) {\n\t\treturn null;\n\t}\n\n\treturn (\n\t\t<div\n\t\t\tref={ menuRef }\n\t\t\tclassName=\"liveblog-autocomplete-menu\"\n\t\t\tstyle={ {\n\t\t\t\tposition: 'fixed',\n\t\t\t\ttop: menuPosition.top,\n\t\t\t\tleft: menuPosition.left,\n\t\t\t\tzIndex: 1000,\n\t\t\t} }\n\t\t>\n\t\t\t<ul className=\"liveblog-autocomplete-list\">\n\t\t\t\t{ suggestions.map( ( suggestion, index ) => {\n\t\t\t\t\t// Handle different suggestion types\n\t\t\t\t\tlet displayText;\n\t\t\t\t\tlet avatarHtml = null;\n\n\t\t\t\t\tif ( typeof suggestion === 'string' ) {\n\t\t\t\t\t\tdisplayText = suggestion;\n\t\t\t\t\t} else if ( suggestion.image && suggestion.key ) {\n\t\t\t\t\t\t// Emoji - has image (unicode codepoint) and key (shortcode)\n\t\t\t\t\t\tdisplayText = `:${ suggestion.key }:`;\n\t\t\t\t\t} else if ( suggestion.name ) {\n\t\t\t\t\t\t// Author or hashtag\n\t\t\t\t\t\tdisplayText = suggestion.name;\n\t\t\t\t\t\t// Avatar is HTML string, not a URL\n\t\t\t\t\t\tif ( suggestion.avatar ) {\n\t\t\t\t\t\t\tavatarHtml = suggestion.avatar;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdisplayText = String( suggestion );\n\t\t\t\t\t}\n\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<li\n\t\t\t\t\t\t\tkey={ index }\n\t\t\t\t\t\t\tclassName={ `liveblog-autocomplete-item${\n\t\t\t\t\t\t\t\tindex === selectedIndex ? ' is-selected' : ''\n\t\t\t\t\t\t\t}` }\n\t\t\t\t\t\t\tonClick={ () => selectSuggestion( suggestion ) }\n\t\t\t\t\t\t\tonMouseEnter={ () => setSelectedIndex( index ) }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ avatarHtml && (\n\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\tclassName=\"liveblog-autocomplete-avatar\"\n\t\t\t\t\t\t\t\t\tdangerouslySetInnerHTML={ { __html: avatarHtml } }\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t<span className=\"liveblog-autocomplete-text\">\n\t\t\t\t\t\t\t\t{ displayText }\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t);\n\t\t\t\t} ) }\n\t\t\t</ul>\n\t\t</div>\n\t);\n}\n\nAutocompletePlugin.propTypes = {\n\tsuggestions: PropTypes.array,\n\tonSearch: PropTypes.func,\n};\n\n// ============================================================================\n// Toolbar Components\n// ============================================================================\n\n/**\n * Toolbar button component using Dashicons.\n */\nfunction ToolbarButton( { onClick, icon, title, isActive = false, disabled = false } ) {\n\treturn (\n\t\t<button\n\t\t\ttype=\"button\"\n\t\t\tonClick={ onClick }\n\t\t\ttitle={ title }\n\t\t\tclassName={ `liveblog-editor-btn${ isActive ? ' is-active' : '' }` }\n\t\t\tdisabled={ disabled }\n\t\t\taria-label={ title }\n\t\t>\n\t\t\t<span className={ `dashicons dashicons-${ icon }` } />\n\t\t</button>\n\t);\n}\n\nToolbarButton.propTypes = {\n\tonClick: PropTypes.func.isRequired,\n\ticon: PropTypes.string.isRequired,\n\ttitle: PropTypes.string.isRequired,\n\tisActive: PropTypes.bool,\n\tdisabled: PropTypes.bool,\n};\n\n/**\n * Link input modal component.\n */\nfunction LinkInput( { url, onChange, onConfirm, onCancel } ) {\n\treturn (\n\t\t<div className=\"liveblog-editor-input-container\">\n\t\t\t<input\n\t\t\t\tclassName=\"liveblog-input\"\n\t\t\t\ttype=\"url\"\n\t\t\t\tvalue={ url }\n\t\t\t\tonChange={ ( e ) => onChange( e.target.value ) }\n\t\t\t\tplaceholder=\"https://\"\n\t\t\t\t// eslint-disable-next-line jsx-a11y/no-autofocus\n\t\t\t\tautoFocus\n\t\t\t\tonKeyDown={ ( e ) => {\n\t\t\t\t\tif ( e.key === 'Enter' ) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tonConfirm();\n\t\t\t\t\t} else if ( e.key === 'Escape' ) {\n\t\t\t\t\t\tonCancel();\n\t\t\t\t\t}\n\t\t\t\t} }\n\t\t\t/>\n\t\t\t<button\n\t\t\t\ttype=\"button\"\n\t\t\t\tclassName=\"liveblog-editor-btn liveblog-input-enter\"\n\t\t\t\tonClick={ onConfirm }\n\t\t\t\ttitle=\"Add link\"\n\t\t\t>\n\t\t\t\t<span className=\"dashicons dashicons-yes\" />\n\t\t\t</button>\n\t\t\t<button\n\t\t\t\ttype=\"button\"\n\t\t\t\tclassName=\"liveblog-editor-btn liveblog-input-cancel\"\n\t\t\t\tonClick={ onCancel }\n\t\t\t\ttitle=\"Cancel\"\n\t\t\t>\n\t\t\t\t<span className=\"dashicons dashicons-no-alt\" />\n\t\t\t</button>\n\t\t</div>\n\t);\n}\n\nLinkInput.propTypes = {\n\turl: PropTypes.string.isRequired,\n\tonChange: PropTypes.func.isRequired,\n\tonConfirm: PropTypes.func.isRequired,\n\tonCancel: PropTypes.func.isRequired,\n};\n\n/**\n * Get the current selection state for toolbar active states.\n */\nfunction getSelectionState( editor ) {\n\tconst state = {\n\t\tisBold: false,\n\t\tisItalic: false,\n\t\tisUnderline: false,\n\t\tisLink: false,\n\t\tisQuote: false,\n\t\tlistType: null,\n\t};\n\n\teditor.getEditorState().read( () => {\n\t\tconst selection = $getSelection();\n\t\tif ( ! $isRangeSelection( selection ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tstate.isBold = selection.hasFormat( 'bold' );\n\t\tstate.isItalic = selection.hasFormat( 'italic' );\n\t\tstate.isUnderline = selection.hasFormat( 'underline' );\n\n\t\tconst anchorNode = selection.anchor.getNode();\n\t\tconst element = anchorNode.getKey() === 'root'\n\t\t\t? anchorNode\n\t\t\t: anchorNode.getTopLevelElementOrThrow();\n\n\t\t// Check for quote\n\t\tif ( $isQuoteNode( element ) ) {\n\t\t\tstate.isQuote = true;\n\t\t}\n\n\t\t// Check for list\n\t\tif ( $isListNode( element ) ) {\n\t\t\tstate.listType = element.getListType();\n\t\t} else {\n\t\t\tconst parent = anchorNode.getParent();\n\t\t\tif ( parent ) {\n\t\t\t\tconst listNode = $getNearestNodeOfType( parent, ListNode );\n\t\t\t\tif ( listNode ) {\n\t\t\t\t\tstate.listType = listNode.getListType();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Check for link\n\t\tconst node = selection.anchor.getNode();\n\t\tconst parent = node.getParent();\n\t\tstate.isLink = $isLinkNode( parent ) || $isLinkNode( node );\n\t} );\n\n\treturn state;\n}\n\n/**\n * Complete toolbar for text formatting.\n */\nfunction ToolbarPlugin( { readOnly, handleImageUpload } ) {\n\tconst [ editor ] = useLexicalComposerContext();\n\tconst [ selectionState, setSelectionState ] = useState( {\n\t\tisBold: false,\n\t\tisItalic: false,\n\t\tisUnderline: false,\n\t\tisLink: false,\n\t\tisQuote: false,\n\t\tlistType: null,\n\t} );\n\tconst [ showLinkInput, setShowLinkInput ] = useState( false );\n\tconst [ linkUrl, setLinkUrl ] = useState( 'https://' );\n\tconst [ isUploading, setIsUploading ] = useState( false );\n\tconst fileInputRef = useRef( null );\n\n\t// Update selection state when selection changes\n\tuseEffect( () => {\n\t\treturn editor.registerCommand(\n\t\t\tSELECTION_CHANGE_COMMAND,\n\t\t\t() => {\n\t\t\t\tsetSelectionState( getSelectionState( editor ) );\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tCOMMAND_PRIORITY_CRITICAL\n\t\t);\n\t}, [ editor ] );\n\n\tconst formatBold = useCallback( () => {\n\t\teditor.dispatchCommand( FORMAT_TEXT_COMMAND, 'bold' );\n\t}, [ editor ] );\n\n\tconst formatItalic = useCallback( () => {\n\t\teditor.dispatchCommand( FORMAT_TEXT_COMMAND, 'italic' );\n\t}, [ editor ] );\n\n\tconst formatUnderline = useCallback( () => {\n\t\teditor.dispatchCommand( FORMAT_TEXT_COMMAND, 'underline' );\n\t}, [ editor ] );\n\n\tconst formatOrderedList = useCallback( () => {\n\t\tif ( selectionState.listType === 'number' ) {\n\t\t\teditor.dispatchCommand( REMOVE_LIST_COMMAND, undefined );\n\t\t} else {\n\t\t\teditor.dispatchCommand( INSERT_ORDERED_LIST_COMMAND, undefined );\n\t\t}\n\t}, [ editor, selectionState.listType ] );\n\n\tconst formatUnorderedList = useCallback( () => {\n\t\tif ( selectionState.listType === 'bullet' ) {\n\t\t\teditor.dispatchCommand( REMOVE_LIST_COMMAND, undefined );\n\t\t} else {\n\t\t\teditor.dispatchCommand( INSERT_UNORDERED_LIST_COMMAND, undefined );\n\t\t}\n\t}, [ editor, selectionState.listType ] );\n\n\tconst formatQuote = useCallback( () => {\n\t\teditor.update( () => {\n\t\t\tconst selection = $getSelection();\n\t\t\tif ( ! $isRangeSelection( selection ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( selectionState.isQuote ) {\n\t\t\t\t// Remove quote - convert back to paragraph\n\t\t\t\t$setBlocksType( selection, () => $createParagraphNode() );\n\t\t\t} else {\n\t\t\t\t// Add quote\n\t\t\t\t$setBlocksType( selection, () => $createQuoteNode() );\n\t\t\t}\n\t\t} );\n\t}, [ editor, selectionState.isQuote ] );\n\n\tconst openLinkModal = useCallback( () => {\n\t\teditor.getEditorState().read( () => {\n\t\t\tconst selection = $getSelection();\n\t\t\tif ( ! $isRangeSelection( selection ) || selection.isCollapsed() ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Check if there's an existing link\n\t\t\tconst node = selection.anchor.getNode();\n\t\t\tconst parent = node.getParent();\n\t\t\tif ( $isLinkNode( parent ) ) {\n\t\t\t\tsetLinkUrl( parent.getURL() );\n\t\t\t} else if ( $isLinkNode( node ) ) {\n\t\t\t\tsetLinkUrl( node.getURL() );\n\t\t\t} else {\n\t\t\t\tsetLinkUrl( 'https://' );\n\t\t\t}\n\n\t\t\tsetShowLinkInput( true );\n\t\t} );\n\t}, [ editor ] );\n\n\tconst insertLink = useCallback( () => {\n\t\tif ( linkUrl && linkUrl !== 'https://' ) {\n\t\t\teditor.dispatchCommand( TOGGLE_LINK_COMMAND, linkUrl );\n\t\t}\n\t\tsetShowLinkInput( false );\n\t\tsetLinkUrl( 'https://' );\n\t}, [ editor, linkUrl ] );\n\n\tconst removeLink = useCallback( () => {\n\t\teditor.dispatchCommand( TOGGLE_LINK_COMMAND, null );\n\t\tsetShowLinkInput( false );\n\t}, [ editor ] );\n\n\tconst cancelLink = useCallback( () => {\n\t\tsetShowLinkInput( false );\n\t\tsetLinkUrl( 'https://' );\n\t}, [] );\n\n\tconst handleImageButtonClick = useCallback( () => {\n\t\tfileInputRef.current?.click();\n\t}, [] );\n\n\tconst handleFileSelect = useCallback( ( event ) => {\n\t\tconst file = event.target.files?.[ 0 ];\n\t\tif ( file && file.type.startsWith( 'image/' ) && handleImageUpload ) {\n\t\t\tsetIsUploading( true );\n\t\t\thandleImageUpload( file )\n\t\t\t\t.then( ( src ) => {\n\t\t\t\t\teditor.dispatchCommand( INSERT_IMAGE_COMMAND, {\n\t\t\t\t\t\tsrc,\n\t\t\t\t\t\talt: file.name,\n\t\t\t\t\t} );\n\t\t\t\t} )\n\t\t\t\t.catch( ( err ) => {\n\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\tconsole.error( 'Image upload failed:', err );\n\t\t\t\t} )\n\t\t\t\t.finally( () => {\n\t\t\t\t\tsetIsUploading( false );\n\t\t\t\t\t// Reset input so same file can be selected again\n\t\t\t\t\tif ( fileInputRef.current ) {\n\t\t\t\t\t\tfileInputRef.current.value = '';\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t}\n\t}, [ editor, handleImageUpload ] );\n\n\treturn (\n\t\t<div className=\"liveblog-editor-toolbar-container\">\n\t\t\t<div className=\"liveblog-toolbar\">\n\t\t\t\t<ToolbarButton\n\t\t\t\t\tonClick={ formatBold }\n\t\t\t\t\ticon=\"editor-bold\"\n\t\t\t\t\ttitle=\"Bold (Ctrl+B)\"\n\t\t\t\t\tisActive={ selectionState.isBold }\n\t\t\t\t\tdisabled={ readOnly }\n\t\t\t\t/>\n\t\t\t\t<ToolbarButton\n\t\t\t\t\tonClick={ formatItalic }\n\t\t\t\t\ticon=\"editor-italic\"\n\t\t\t\t\ttitle=\"Italic (Ctrl+I)\"\n\t\t\t\t\tisActive={ selectionState.isItalic }\n\t\t\t\t\tdisabled={ readOnly }\n\t\t\t\t/>\n\t\t\t\t<ToolbarButton\n\t\t\t\t\tonClick={ formatUnderline }\n\t\t\t\t\ticon=\"editor-underline\"\n\t\t\t\t\ttitle=\"Underline (Ctrl+U)\"\n\t\t\t\t\tisActive={ selectionState.isUnderline }\n\t\t\t\t\tdisabled={ readOnly }\n\t\t\t\t/>\n\t\t\t\t<ToolbarButton\n\t\t\t\t\tonClick={ formatOrderedList }\n\t\t\t\t\ticon=\"editor-ol\"\n\t\t\t\t\ttitle=\"Ordered List\"\n\t\t\t\t\tisActive={ selectionState.listType === 'number' }\n\t\t\t\t\tdisabled={ readOnly }\n\t\t\t\t/>\n\t\t\t\t<ToolbarButton\n\t\t\t\t\tonClick={ formatUnorderedList }\n\t\t\t\t\ticon=\"editor-ul\"\n\t\t\t\t\ttitle=\"Unordered List\"\n\t\t\t\t\tisActive={ selectionState.listType === 'bullet' }\n\t\t\t\t\tdisabled={ readOnly }\n\t\t\t\t/>\n\t\t\t\t<ToolbarButton\n\t\t\t\t\tonClick={ formatQuote }\n\t\t\t\t\ticon=\"format-quote\"\n\t\t\t\t\ttitle=\"Blockquote\"\n\t\t\t\t\tisActive={ selectionState.isQuote }\n\t\t\t\t\tdisabled={ readOnly }\n\t\t\t\t/>\n\t\t\t\t<div style={ { position: 'relative', display: 'inline-block' } }>\n\t\t\t\t\t<ToolbarButton\n\t\t\t\t\t\tonClick={ openLinkModal }\n\t\t\t\t\t\ticon=\"admin-links\"\n\t\t\t\t\t\ttitle=\"Add Link\"\n\t\t\t\t\t\tisActive={ selectionState.isLink }\n\t\t\t\t\t\tdisabled={ readOnly }\n\t\t\t\t\t/>\n\t\t\t\t\t{ showLinkInput && (\n\t\t\t\t\t\t<LinkInput\n\t\t\t\t\t\t\turl={ linkUrl }\n\t\t\t\t\t\t\tonChange={ setLinkUrl }\n\t\t\t\t\t\t\tonConfirm={ insertLink }\n\t\t\t\t\t\t\tonCancel={ cancelLink }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t</div>\n\t\t\t\t<ToolbarButton\n\t\t\t\t\tonClick={ removeLink }\n\t\t\t\t\ticon=\"editor-unlink\"\n\t\t\t\t\ttitle=\"Remove Link\"\n\t\t\t\t\tdisabled={ readOnly || ! selectionState.isLink }\n\t\t\t\t/>\n\t\t\t\t{ handleImageUpload && (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<ToolbarButton\n\t\t\t\t\t\t\tonClick={ handleImageButtonClick }\n\t\t\t\t\t\t\ticon=\"format-image\"\n\t\t\t\t\t\t\ttitle={ isUploading ? 'Uploading...' : 'Insert Image' }\n\t\t\t\t\t\t\tdisabled={ readOnly || isUploading }\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tref={ fileInputRef }\n\t\t\t\t\t\t\ttype=\"file\"\n\t\t\t\t\t\t\taccept=\"image/*\"\n\t\t\t\t\t\t\tonChange={ handleFileSelect }\n\t\t\t\t\t\t\tstyle={ { display: 'none' } }\n\t\t\t\t\t\t/>\n\t\t\t\t\t</>\n\t\t\t\t) }\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n\nToolbarPlugin.propTypes = {\n\treadOnly: PropTypes.bool,\n\thandleImageUpload: PropTypes.func,\n};\n\n// ============================================================================\n// Main Component\n// ============================================================================\n\n/**\n * Main Lexical Editor component.\n *\n * @param {Object}   props                   - Component props.\n * @param {string}   props.initialContent    - Initial HTML content to load.\n * @param {Function} props.onChange          - Callback when content changes, receives HTML string.\n * @param {boolean}  props.readOnly          - Whether the editor is read-only.\n * @param {Function} props.handleImageUpload - Function to handle image uploads.\n * @param {Array}    props.suggestions       - Autocomplete suggestions to display.\n * @param {Function} props.onSearch          - Callback when autocomplete trigger detected.\n */\nconst LexicalEditor = ( {\n\tinitialContent = '',\n\tonChange = null,\n\treadOnly = false,\n\thandleImageUpload = null,\n\tsuggestions = [],\n\tonSearch = null,\n} ) => {\n\tconst initialConfig = {\n\t\tnamespace: 'LiveblogEditor',\n\t\ttheme,\n\t\tnodes,\n\t\teditable: ! readOnly,\n\t\tonError: ( error ) => {\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.error( 'Lexical error:', error );\n\t\t},\n\t};\n\n\treturn (\n\t\t<div className=\"liveblog-lexical-editor\">\n\t\t\t<LexicalComposer initialConfig={ initialConfig }>\n\t\t\t\t<ToolbarPlugin readOnly={ readOnly } handleImageUpload={ handleImageUpload } />\n\t\t\t\t<div className=\"liveblog-lexical-editor-inner\">\n\t\t\t\t\t<RichTextPlugin\n\t\t\t\t\t\tcontentEditable={\n\t\t\t\t\t\t\t<ContentEditable className=\"liveblog-lexical-content-editable\" />\n\t\t\t\t\t\t}\n\t\t\t\t\t\tplaceholder={\n\t\t\t\t\t\t\t<div className=\"liveblog-lexical-placeholder\">\n\t\t\t\t\t\t\t\tStart writing your liveblog entry...\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t}\n\t\t\t\t\t\tErrorBoundary={ LexicalErrorBoundary }\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<HistoryPlugin />\n\t\t\t\t<LinkPlugin />\n\t\t\t\t<ListPlugin />\n\t\t\t\t<ImagePlugin handleImageUpload={ handleImageUpload } />\n\t\t\t\t<AutocompletePlugin\n\t\t\t\t\tsuggestions={ suggestions }\n\t\t\t\t\tonSearch={ onSearch }\n\t\t\t\t/>\n\t\t\t\t<InitialContentPlugin initialContent={ initialContent } />\n\t\t\t\t<HtmlExportPlugin onChange={ onChange } />\n\t\t\t</LexicalComposer>\n\t\t</div>\n\t);\n};\n\nLexicalEditor.propTypes = {\n\tinitialContent: PropTypes.string,\n\tonChange: PropTypes.func,\n\treadOnly: PropTypes.bool,\n\thandleImageUpload: PropTypes.func,\n\tsuggestions: PropTypes.array,\n\tonSearch: PropTypes.func,\n};\n\nexport default LexicalEditor;\n"],"names":["INSERT_IMAGE_COMMAND","createCommand","ImageNode","DecoratorNode","__src","__alt","__attributes","getType","clone","node","__key","constructor","src","alt","attributes","key","super","this","createDOM","span","document","createElement","className","updateDOM","importJSON","serializedNode","$createImageNode","exportJSON","type","version","importDOM","img","conversion","convertImageElement","priority","exportDOM","Object","entries","forEach","value","setAttribute","element","decorate","_jsx","domNode","HTMLImageElement","getAttribute","attr","name","theme","paragraph","heading","h1","h2","h3","list","ul","ol","listitem","nested","text","bold","italic","underline","strikethrough","link","quote","image","nodes","HeadingNode","QuoteNode","ListNode","ListItemNode","LinkNode","AutoLinkNode","InitialContentPlugin","initialContent","editor","useLexicalComposerContext","hasLoadedRef","useRef","useEffect","current","update","dom","DOMParser","parseFromString","generatedNodes","$generateNodesFromDOM","root","$getRoot","clear","select","$insertNodes","HtmlExportPlugin","onChange","handleChange","useCallback","editorState","read","html","cleaned","replace","cleanLexicalHtml","$generateHtmlFromNodes","OnChangePlugin","ImagePlugin","handleImageUpload","unregisterInsertImage","registerCommand","payload","imageNode","selection","$getSelection","$isRangeSelection","insertNodes","$createParagraphNode","append","COMMAND_PRIORITY_EDITOR","unregisterDragOver","DRAGOVER_COMMAND","event","hasFiles","dataTransfer","types","includes","preventDefault","COMMAND_PRIORITY_HIGH","unregisterDrop","DROP_COMMAND","files","length","imageFiles","Array","from","filter","file","startsWith","reduce","promise","then","dispatchCommand","catch","err","console","error","Promise","resolve","AUTOCOMPLETE_TRIGGERS","AutocompletePlugin","suggestions","onSearch","triggerMatch","setTriggerMatch","useState","selectedIndex","setSelectedIndex","menuPosition","setMenuPosition","top","left","menuRef","triggerMatchRef","selectedIndexRef","selectSuggestion","suggestion","match","anchorNode","anchor","getNode","textContent","getTextContent","trigger","startOffset","endOffset","replacementText","newText","slice","setTextContent","newOffset","set","getKey","focus","unregisterEnter","KEY_ENTER_COMMAND","unregisterTab","KEY_TAB_COMMAND","unregisterArrowDown","KEY_ARROW_DOWN_COMMAND","prev","unregisterArrowUp","KEY_ARROW_UP_COMMAND","unregisterEscape","KEY_ESCAPE_COMMAND","registerUpdateListener","result","getEditorState","isCollapsed","offset","i","char","getTriggerMatch","window","getSelection","rangeCount","rect","getRangeAt","getBoundingClientRect","bottom","ref","style","position","zIndex","children","map","index","displayText","avatarHtml","avatar","String","_jsxs","onClick","onMouseEnter","dangerouslySetInnerHTML","__html","ToolbarButton","icon","title","isActive","disabled","LinkInput","url","onConfirm","onCancel","e","target","placeholder","autoFocus","onKeyDown","ToolbarPlugin","readOnly","selectionState","setSelectionState","isBold","isItalic","isUnderline","isLink","isQuote","listType","showLinkInput","setShowLinkInput","linkUrl","setLinkUrl","isUploading","setIsUploading","fileInputRef","SELECTION_CHANGE_COMMAND","state","hasFormat","getTopLevelElementOrThrow","$isQuoteNode","$isListNode","getListType","parent","getParent","listNode","$getNearestNodeOfType","$isLinkNode","getSelectionState","COMMAND_PRIORITY_CRITICAL","formatBold","FORMAT_TEXT_COMMAND","formatItalic","formatUnderline","formatOrderedList","REMOVE_LIST_COMMAND","undefined","INSERT_ORDERED_LIST_COMMAND","formatUnorderedList","INSERT_UNORDERED_LIST_COMMAND","formatQuote","$setBlocksType","$createQuoteNode","openLinkModal","getURL","insertLink","TOGGLE_LINK_COMMAND","removeLink","cancelLink","handleImageButtonClick","click","handleFileSelect","finally","display","_Fragment","accept","propTypes","PropTypes","isRequired","LexicalEditor","initialConfig","namespace","editable","onError","LexicalComposer","RichTextPlugin","contentEditable","ContentEditable","ErrorBoundary","LexicalErrorBoundary","HistoryPlugin","LinkPlugin","ListPlugin"],"ignoreList":[],"sourceRoot":""}