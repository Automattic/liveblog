"use strict";(globalThis.wpJsonpLiveBlog=globalThis.wpJsonpLiveBlog||[]).push([[749],{9130(e,i,l){l.r(i),l.d(i,{default:()=>R});var t=l(1609),n=l(5556),s=l.n(n),o=l(6246),a=l(3570),c=l(83),r=l(290),d=l(5838),u=l(4439),b=l(7704),p=l(3439),g=l(43),h=l(1544),v=l(9325),m=l(1497),C=l(1885),x=l(8832),k=l(3105),y=l(790);const j={paragraph:"liveblog-lexical-paragraph",heading:{h1:"liveblog-lexical-h1",h2:"liveblog-lexical-h2",h3:"liveblog-lexical-h3"},list:{ul:"liveblog-lexical-ul",ol:"liveblog-lexical-ol",listitem:"liveblog-lexical-li",nested:{listitem:"liveblog-lexical-li-nested"}},text:{bold:"liveblog-lexical-bold",italic:"liveblog-lexical-italic",underline:"liveblog-lexical-underline",strikethrough:"liveblog-lexical-strikethrough"},link:"liveblog-lexical-link",quote:"liveblog-lexical-quote"},f=[h.jL,h.dJ,v.v5,v.YW,m.Db,m.k_];function T({initialContent:e}){const[i]=(0,u.DF)(),l=(0,t.useRef)(!1);return(0,t.useEffect)(()=>{!l.current&&e&&(l.current=!0,i.update(()=>{const l=(new DOMParser).parseFromString(e,"text/html"),t=(0,C.d)(i,l),n=(0,x.NiT)();n.clear(),n.select(),(0,x.H2A)(t)}))},[i,e]),null}function L({onChange:e}){const[i]=(0,u.DF)(),l=(0,t.useCallback)(l=>{e&&l.read(()=>{const l=function(e){let i=e;return i=i.replace(/ style="white-space: pre-wrap;"/g,""),i=i.replace(/ class="liveblog-lexical-[^"]*"/g,""),i=i.replace(/<i>(<em[^>]*>)/g,"$1"),i=i.replace(/<\/em><\/i>/g,"</em>"),i=i.replace(/<b>(<strong[^>]*>)/g,"$1"),i=i.replace(/<\/strong><\/b>/g,"</strong>"),i=i.replace(/<span>([^<]*)<\/span>/g,"$1"),i}((0,C.g)(i,null));e(l)})},[i,e]);return(0,y.jsx)(d.D,{onChange:l})}function N({onClick:e,icon:i,title:l,isActive:t=!1,disabled:n=!1}){return(0,y.jsx)("button",{type:"button",onClick:e,title:l,className:"liveblog-editor-btn"+(t?" is-active":""),disabled:n,"aria-label":l,children:(0,y.jsx)("span",{className:`dashicons dashicons-${i}`})})}function q({url:e,onChange:i,onConfirm:l,onCancel:t}){return(0,y.jsxs)("div",{className:"liveblog-editor-input-container",children:[(0,y.jsx)("input",{className:"liveblog-input",type:"url",value:e,onChange:e=>i(e.target.value),placeholder:"https://",autoFocus:!0,onKeyDown:e=>{"Enter"===e.key?(e.preventDefault(),l()):"Escape"===e.key&&t()}}),(0,y.jsx)("button",{type:"button",className:"liveblog-editor-btn liveblog-input-enter",onClick:l,title:"Add link",children:(0,y.jsx)("span",{className:"dashicons dashicons-yes"})}),(0,y.jsx)("button",{type:"button",className:"liveblog-editor-btn liveblog-input-cancel",onClick:t,title:"Cancel",children:(0,y.jsx)("span",{className:"dashicons dashicons-no-alt"})})]})}function B({readOnly:e}){const[i]=(0,u.DF)(),[l,n]=(0,t.useState)({isBold:!1,isItalic:!1,isUnderline:!1,isLink:!1,listType:null}),[s,o]=(0,t.useState)(!1),[a,c]=(0,t.useState)("https://");(0,t.useEffect)(()=>i.registerCommand(x.MvL,()=>(n(function(e){const i={isBold:!1,isItalic:!1,isUnderline:!1,isLink:!1,listType:null};return e.getEditorState().read(()=>{const e=(0,x.vJq)();if(!(0,x.I2P)(e))return;i.isBold=e.hasFormat("bold"),i.isItalic=e.hasFormat("italic"),i.isUnderline=e.hasFormat("underline");const l=e.anchor.getNode(),t="root"===l.getKey()?l:l.getTopLevelElementOrThrow();if((0,v.HY)(t))i.listType=t.getListType();else{const e=l.getParent();if(e){const l=(0,k.eu)(e,v.v5);l&&(i.listType=l.getListType())}}const n=e.anchor.getNode(),s=n.getParent();i.isLink=(0,m.FJ)(s)||(0,m.FJ)(n)}),i}(i)),!1),x.da8),[i]);const r=(0,t.useCallback)(()=>{i.dispatchCommand(x.mB,"bold")},[i]),d=(0,t.useCallback)(()=>{i.dispatchCommand(x.mB,"italic")},[i]),b=(0,t.useCallback)(()=>{i.dispatchCommand(x.mB,"underline")},[i]),p=(0,t.useCallback)(()=>{"number"===l.listType?i.dispatchCommand(v.uS,void 0):i.dispatchCommand(v.x,void 0)},[i,l.listType]),g=(0,t.useCallback)(()=>{"bullet"===l.listType?i.dispatchCommand(v.uS,void 0):i.dispatchCommand(v.q7,void 0)},[i,l.listType]),h=(0,t.useCallback)(()=>{i.getEditorState().read(()=>{const e=(0,x.vJq)();if(!(0,x.I2P)(e)||e.isCollapsed())return;const i=e.anchor.getNode(),l=i.getParent();(0,m.FJ)(l)?c(l.getURL()):(0,m.FJ)(i)?c(i.getURL()):c("https://"),o(!0)})},[i]),C=(0,t.useCallback)(()=>{a&&"https://"!==a&&i.dispatchCommand(m.yW,a),o(!1),c("https://")},[i,a]),j=(0,t.useCallback)(()=>{i.dispatchCommand(m.yW,null),o(!1)},[i]),f=(0,t.useCallback)(()=>{o(!1),c("https://")},[]);return(0,y.jsx)("div",{className:"liveblog-editor-toolbar-container",children:(0,y.jsxs)("div",{className:"liveblog-toolbar",children:[(0,y.jsx)(N,{onClick:r,icon:"editor-bold",title:"Bold (Ctrl+B)",isActive:l.isBold,disabled:e}),(0,y.jsx)(N,{onClick:d,icon:"editor-italic",title:"Italic (Ctrl+I)",isActive:l.isItalic,disabled:e}),(0,y.jsx)(N,{onClick:b,icon:"editor-underline",title:"Underline (Ctrl+U)",isActive:l.isUnderline,disabled:e}),(0,y.jsx)(N,{onClick:p,icon:"editor-ol",title:"Ordered List",isActive:"number"===l.listType,disabled:e}),(0,y.jsx)(N,{onClick:g,icon:"editor-ul",title:"Unordered List",isActive:"bullet"===l.listType,disabled:e}),(0,y.jsxs)("div",{style:{position:"relative",display:"inline-block"},children:[(0,y.jsx)(N,{onClick:h,icon:"admin-links",title:"Add Link",isActive:l.isLink,disabled:e}),s&&(0,y.jsx)(q,{url:a,onChange:c,onConfirm:C,onCancel:f})]}),(0,y.jsx)(N,{onClick:j,icon:"editor-unlink",title:"Remove Link",disabled:e||!l.isLink})]})})}N.propTypes={onClick:s().func.isRequired,icon:s().string.isRequired,title:s().string.isRequired,isActive:s().bool,disabled:s().bool},q.propTypes={url:s().string.isRequired,onChange:s().func.isRequired,onConfirm:s().func.isRequired,onCancel:s().func.isRequired},B.propTypes={readOnly:s().bool};const F=({initialContent:e="",onChange:i=null,readOnly:l=!1})=>{const t={namespace:"LiveblogEditor",theme:j,nodes:f,editable:!l,onError:e=>{console.error("Lexical error:",e)}};return(0,y.jsx)("div",{className:"liveblog-lexical-editor",children:(0,y.jsxs)(o.n,{initialConfig:t,children:[(0,y.jsx)(B,{readOnly:l}),(0,y.jsx)("div",{className:"liveblog-lexical-editor-inner",children:(0,y.jsx)(a.$,{contentEditable:(0,y.jsx)(c.a,{className:"liveblog-lexical-content-editable"}),placeholder:(0,y.jsx)("div",{className:"liveblog-lexical-placeholder",children:"Start writing your liveblog entry..."}),ErrorBoundary:b.R})}),(0,y.jsx)(r.G,{}),(0,y.jsx)(p.W,{}),(0,y.jsx)(g.Q,{}),(0,y.jsx)(T,{initialContent:e}),(0,y.jsx)(L,{onChange:i})]})})};F.propTypes={initialContent:s().string,onChange:s().func,readOnly:s().bool};const R=F}}]);
//# sourceMappingURL=749.bundle.js.map